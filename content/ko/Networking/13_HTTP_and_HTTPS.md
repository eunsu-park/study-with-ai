# HTTP와 HTTPS

## 개요

HTTP(HyperText Transfer Protocol)는 웹에서 클라이언트와 서버 간 데이터를 주고받기 위한 애플리케이션 계층 프로토콜입니다. HTTPS는 HTTP에 TLS/SSL 암호화를 추가하여 보안을 강화한 프로토콜입니다.

**난이도**: ⭐⭐⭐

**학습 목표**:
- HTTP 요청/응답 구조 이해
- HTTP 메서드와 상태 코드 숙지
- HTTP 버전별 차이점 파악
- HTTPS와 TLS/SSL 동작 원리 이해

---

## 목차

1. [HTTP 기초](#1-http-기초)
2. [HTTP 메서드](#2-http-메서드)
3. [HTTP 상태 코드](#3-http-상태-코드)
4. [HTTP 헤더](#4-http-헤더)
5. [HTTP 버전 비교](#5-http-버전-비교)
6. [HTTPS와 TLS/SSL](#6-https와-tlsssl)
7. [인증서](#7-인증서)
8. [연습 문제](#8-연습-문제)
9. [다음 단계](#9-다음-단계)
10. [참고 자료](#10-참고-자료)

---

## 1. HTTP 기초

### HTTP 통신 구조

```
┌──────────────┐                              ┌──────────────┐
│   클라이언트   │                              │     서버     │
│  (브라우저)   │                              │  (웹 서버)   │
├──────────────┤                              ├──────────────┤
│              │  ──── HTTP 요청 ────────▶   │              │
│   GET /index │  (메서드, URL, 헤더, 바디)    │   Nginx      │
│              │                              │   Apache     │
│              │  ◀──── HTTP 응답 ────────   │              │
│   HTML 페이지 │  (상태코드, 헤더, 바디)       │              │
└──────────────┘                              └──────────────┘
        │                                            │
        │           TCP 연결 (기본 포트 80)            │
        └────────────────────────────────────────────┘
```

### HTTP 특성

| 특성 | 설명 |
|------|------|
| 비연결성 (Connectionless) | 요청-응답 후 연결 종료 (HTTP/1.0) |
| 무상태 (Stateless) | 각 요청은 독립적, 이전 상태 미보관 |
| 텍스트 기반 | 사람이 읽을 수 있는 형식 |
| 요청-응답 | 클라이언트 요청, 서버 응답 |

### HTTP 요청 구조

```
┌─────────────────────────────────────────────────────────┐
│ 요청 라인 (Request Line)                                 │
├─────────────────────────────────────────────────────────┤
│ GET /api/users HTTP/1.1                                 │
│ └─┘ └────────┘ └───────┘                                │
│ 메서드   URI     버전                                    │
├─────────────────────────────────────────────────────────┤
│ 헤더 (Headers)                                          │
├─────────────────────────────────────────────────────────┤
│ Host: api.example.com                                   │
│ User-Agent: Mozilla/5.0                                 │
│ Accept: application/json                                │
│ Content-Type: application/json                          │
│ Authorization: Bearer eyJhbGciOiJ...                    │
├─────────────────────────────────────────────────────────┤
│ 빈 줄 (CRLF)                                            │
├─────────────────────────────────────────────────────────┤
│ 바디 (Body) - 선택적                                     │
├─────────────────────────────────────────────────────────┤
│ {"name": "John", "email": "john@example.com"}           │
└─────────────────────────────────────────────────────────┘
```

### HTTP 응답 구조

```
┌─────────────────────────────────────────────────────────┐
│ 상태 라인 (Status Line)                                  │
├─────────────────────────────────────────────────────────┤
│ HTTP/1.1 200 OK                                         │
│ └───────┘ └─┘ └┘                                        │
│   버전   상태코드 사유                                    │
├─────────────────────────────────────────────────────────┤
│ 헤더 (Headers)                                          │
├─────────────────────────────────────────────────────────┤
│ Content-Type: application/json                          │
│ Content-Length: 128                                     │
│ Date: Mon, 27 Jan 2026 10:30:00 GMT                     │
│ Server: nginx/1.24.0                                    │
│ Cache-Control: no-cache                                 │
├─────────────────────────────────────────────────────────┤
│ 빈 줄 (CRLF)                                            │
├─────────────────────────────────────────────────────────┤
│ 바디 (Body)                                             │
├─────────────────────────────────────────────────────────┤
│ {"id": 1, "name": "John", "status": "active"}           │
└─────────────────────────────────────────────────────────┘
```

### curl로 HTTP 요청 확인

```bash
# 기본 GET 요청
curl http://example.com

# 헤더 포함 출력
curl -i http://example.com

# 요청/응답 상세 확인
curl -v http://example.com

# 헤더만 출력
curl -I http://example.com

# JSON POST 요청
curl -X POST http://api.example.com/users \
  -H "Content-Type: application/json" \
  -d '{"name": "John"}'
```

---

## 2. HTTP 메서드

### 주요 HTTP 메서드

```
┌────────────┬──────────────────────────────────────────────┐
│   메서드    │                    설명                       │
├────────────┼──────────────────────────────────────────────┤
│    GET     │ 리소스 조회 (읽기)                             │
│    POST    │ 리소스 생성 (쓰기)                             │
│    PUT     │ 리소스 전체 수정 (대체)                         │
│   PATCH    │ 리소스 일부 수정                               │
│   DELETE   │ 리소스 삭제                                    │
│    HEAD    │ 헤더만 조회 (바디 없음)                         │
│  OPTIONS   │ 지원 메서드 확인                               │
│   TRACE    │ 루프백 테스트 (디버깅)                          │
│  CONNECT   │ 프록시 터널 연결                               │
└────────────┴──────────────────────────────────────────────┘
```

### 메서드 속성

```
┌────────────┬────────────┬──────────────┬──────────────┐
│   메서드    │   안전성    │    멱등성     │   캐시 가능   │
│            │  (Safe)    │ (Idempotent) │ (Cacheable)  │
├────────────┼────────────┼──────────────┼──────────────┤
│    GET     │     O      │      O       │      O       │
│    HEAD    │     O      │      O       │      O       │
│   OPTIONS  │     O      │      O       │      X       │
│    POST    │     X      │      X       │    조건부    │
│    PUT     │     X      │      O       │      X       │
│   DELETE   │     X      │      O       │      X       │
│   PATCH    │     X      │      X       │      X       │
└────────────┴────────────┴──────────────┴──────────────┘

* 안전성: 서버 상태를 변경하지 않음
* 멱등성: 여러 번 실행해도 결과가 동일
* 캐시 가능: 응답을 캐시할 수 있음
```

### GET vs POST 비교

| 특성 | GET | POST |
|------|-----|------|
| 용도 | 데이터 조회 | 데이터 전송/생성 |
| 데이터 위치 | URL 쿼리 스트링 | 요청 바디 |
| 데이터 크기 | URL 길이 제한 (~2KB) | 제한 없음 |
| 캐싱 | 가능 | 기본적으로 불가 |
| 보안 | URL에 노출 | 상대적으로 안전 |
| 북마크 | 가능 | 불가 |

### RESTful API에서의 메서드 활용

```
┌─────────────────────────────────────────────────────────────────┐
│                     RESTful API 예시                             │
├─────────────────────────────────────────────────────────────────┤
│  작업        │ 메서드   │ 엔드포인트         │ 설명              │
├─────────────────────────────────────────────────────────────────┤
│  목록 조회   │ GET     │ /api/users        │ 모든 사용자 조회   │
│  단일 조회   │ GET     │ /api/users/1      │ ID=1 사용자 조회   │
│  생성       │ POST    │ /api/users        │ 새 사용자 생성     │
│  전체 수정   │ PUT     │ /api/users/1      │ 사용자 전체 업데이트 │
│  일부 수정   │ PATCH   │ /api/users/1      │ 사용자 일부 업데이트 │
│  삭제       │ DELETE  │ /api/users/1      │ 사용자 삭제        │
└─────────────────────────────────────────────────────────────────┘
```

### 메서드별 요청 예시

```bash
# GET - 리소스 조회
curl -X GET "http://api.example.com/users?page=1&limit=10"

# POST - 리소스 생성
curl -X POST http://api.example.com/users \
  -H "Content-Type: application/json" \
  -d '{
    "name": "홍길동",
    "email": "hong@example.com"
  }'

# PUT - 전체 수정
curl -X PUT http://api.example.com/users/1 \
  -H "Content-Type: application/json" \
  -d '{
    "name": "홍길동",
    "email": "hong.new@example.com",
    "status": "active"
  }'

# PATCH - 일부 수정
curl -X PATCH http://api.example.com/users/1 \
  -H "Content-Type: application/json" \
  -d '{"status": "inactive"}'

# DELETE - 삭제
curl -X DELETE http://api.example.com/users/1

# HEAD - 헤더만 조회
curl -I http://api.example.com/users/1

# OPTIONS - 지원 메서드 확인
curl -X OPTIONS http://api.example.com/users
```

---

## 3. HTTP 상태 코드

### 상태 코드 분류

```
┌─────────────────────────────────────────────────────────────────┐
│                      HTTP 상태 코드 분류                          │
├─────────────────────────────────────────────────────────────────┤
│  분류   │ 범위      │ 의미                                       │
├─────────────────────────────────────────────────────────────────┤
│  1xx   │ 100-199  │ 정보성 (Informational) - 처리 중             │
│  2xx   │ 200-299  │ 성공 (Success) - 요청 성공                   │
│  3xx   │ 300-399  │ 리다이렉션 (Redirection) - 추가 조치 필요     │
│  4xx   │ 400-499  │ 클라이언트 오류 (Client Error)               │
│  5xx   │ 500-599  │ 서버 오류 (Server Error)                     │
└─────────────────────────────────────────────────────────────────┘
```

### 1xx - 정보성 응답

| 코드 | 이름 | 설명 |
|------|------|------|
| 100 | Continue | 요청 계속 진행 가능 |
| 101 | Switching Protocols | 프로토콜 전환 (WebSocket 등) |
| 102 | Processing | 처리 중 (WebDAV) |

### 2xx - 성공 응답

| 코드 | 이름 | 설명 | 사용 예시 |
|------|------|------|----------|
| 200 | OK | 요청 성공 | GET 성공 |
| 201 | Created | 리소스 생성됨 | POST 성공 |
| 202 | Accepted | 요청 수락됨 (비동기 처리) | 비동기 작업 |
| 204 | No Content | 성공, 응답 바디 없음 | DELETE 성공 |
| 206 | Partial Content | 일부 콘텐츠 | 범위 요청 |

### 3xx - 리다이렉션

| 코드 | 이름 | 설명 | 캐시 |
|------|------|------|------|
| 301 | Moved Permanently | 영구 이동 | 캐시됨 |
| 302 | Found | 임시 이동 | 캐시 안됨 |
| 303 | See Other | 다른 위치 (GET으로 변경) | 캐시 안됨 |
| 304 | Not Modified | 변경 없음 (캐시 사용) | - |
| 307 | Temporary Redirect | 임시 이동 (메서드 유지) | 캐시 안됨 |
| 308 | Permanent Redirect | 영구 이동 (메서드 유지) | 캐시됨 |

### 4xx - 클라이언트 오류

| 코드 | 이름 | 설명 |
|------|------|------|
| 400 | Bad Request | 잘못된 요청 (문법 오류) |
| 401 | Unauthorized | 인증 필요 |
| 403 | Forbidden | 접근 금지 (권한 없음) |
| 404 | Not Found | 리소스 없음 |
| 405 | Method Not Allowed | 허용되지 않은 메서드 |
| 408 | Request Timeout | 요청 시간 초과 |
| 409 | Conflict | 충돌 (동시 수정 등) |
| 413 | Payload Too Large | 요청 바디 너무 큼 |
| 414 | URI Too Long | URI 너무 김 |
| 415 | Unsupported Media Type | 지원하지 않는 미디어 타입 |
| 422 | Unprocessable Entity | 처리 불가능한 엔티티 |
| 429 | Too Many Requests | 요청 횟수 초과 (Rate Limit) |

### 5xx - 서버 오류

| 코드 | 이름 | 설명 |
|------|------|------|
| 500 | Internal Server Error | 서버 내부 오류 |
| 501 | Not Implemented | 구현되지 않음 |
| 502 | Bad Gateway | 게이트웨이 오류 |
| 503 | Service Unavailable | 서비스 이용 불가 |
| 504 | Gateway Timeout | 게이트웨이 시간 초과 |

### 상태 코드 흐름도

```
                        ┌─────────────┐
                        │  HTTP 요청   │
                        └──────┬──────┘
                               │
                        ┌──────▼──────┐
                        │  요청 검증   │
                        └──────┬──────┘
                               │
           ┌───────────────────┼───────────────────┐
           │                   │                   │
    ┌──────▼──────┐     ┌──────▼──────┐     ┌──────▼──────┐
    │  문법 오류   │     │  인증 확인   │     │  권한 확인   │
    └──────┬──────┘     └──────┬──────┘     └──────┬──────┘
           │                   │                   │
    ┌──────▼──────┐     ┌──────▼──────┐     ┌──────▼──────┐
    │    400      │     │    401      │     │    403      │
    │ Bad Request │     │Unauthorized │     │  Forbidden  │
    └─────────────┘     └─────────────┘     └─────────────┘

                        ┌──────────────┐
                        │ 리소스 조회   │
                        └──────┬───────┘
                               │
                 ┌─────────────┼─────────────┐
                 │             │             │
          ┌──────▼──────┐  ┌───▼───┐  ┌──────▼──────┐
          │  리소스 없음  │  │ 성공  │  │  서버 오류   │
          └──────┬──────┘  └───┬───┘  └──────┬──────┘
                 │             │             │
          ┌──────▼──────┐  ┌───▼───┐  ┌──────▼──────┐
          │    404      │  │  200  │  │    500      │
          │  Not Found  │  │  OK   │  │   Internal  │
          └─────────────┘  └───────┘  └─────────────┘
```

---

## 4. HTTP 헤더

### 헤더 분류

```
┌─────────────────────────────────────────────────────────────────┐
│                      HTTP 헤더 분류                              │
├─────────────────────────────────────────────────────────────────┤
│  분류              │ 설명                                        │
├─────────────────────────────────────────────────────────────────┤
│  일반 헤더         │ 요청/응답 모두 사용 (Date, Connection 등)    │
│  요청 헤더         │ 클라이언트 정보 (Host, User-Agent 등)        │
│  응답 헤더         │ 서버 정보 (Server, Set-Cookie 등)            │
│  엔티티 헤더       │ 본문 정보 (Content-Type, Content-Length 등)  │
└─────────────────────────────────────────────────────────────────┘
```

### 주요 요청 헤더

| 헤더 | 설명 | 예시 |
|------|------|------|
| Host | 요청 호스트 | `Host: api.example.com` |
| User-Agent | 클라이언트 정보 | `User-Agent: Mozilla/5.0` |
| Accept | 원하는 응답 타입 | `Accept: application/json` |
| Accept-Language | 선호 언어 | `Accept-Language: ko-KR,ko;q=0.9` |
| Accept-Encoding | 지원 인코딩 | `Accept-Encoding: gzip, deflate` |
| Authorization | 인증 정보 | `Authorization: Bearer token123` |
| Cookie | 쿠키 전송 | `Cookie: session_id=abc123` |
| Content-Type | 요청 바디 타입 | `Content-Type: application/json` |
| Content-Length | 요청 바디 크기 | `Content-Length: 256` |
| Referer | 이전 페이지 URL | `Referer: https://google.com` |
| Origin | 요청 출처 | `Origin: https://example.com` |

### 주요 응답 헤더

| 헤더 | 설명 | 예시 |
|------|------|------|
| Content-Type | 응답 바디 타입 | `Content-Type: text/html; charset=utf-8` |
| Content-Length | 응답 바디 크기 | `Content-Length: 1024` |
| Content-Encoding | 압축 방식 | `Content-Encoding: gzip` |
| Cache-Control | 캐시 제어 | `Cache-Control: max-age=3600` |
| Expires | 만료 시간 | `Expires: Wed, 27 Jan 2027 10:00:00 GMT` |
| ETag | 리소스 버전 식별자 | `ETag: "abc123"` |
| Last-Modified | 마지막 수정 시간 | `Last-Modified: Mon, 01 Jan 2026 00:00:00 GMT` |
| Set-Cookie | 쿠키 설정 | `Set-Cookie: id=abc; HttpOnly; Secure` |
| Location | 리다이렉트 위치 | `Location: https://example.com/new` |
| Server | 서버 정보 | `Server: nginx/1.24.0` |

### 보안 관련 헤더

| 헤더 | 설명 |
|------|------|
| Strict-Transport-Security (HSTS) | HTTPS 강제 |
| X-Content-Type-Options | MIME 스니핑 방지 |
| X-Frame-Options | 클릭재킹 방지 |
| X-XSS-Protection | XSS 필터 활성화 |
| Content-Security-Policy (CSP) | 콘텐츠 보안 정책 |
| Access-Control-Allow-Origin | CORS 허용 출처 |

### 캐싱 관련 헤더

```
┌─────────────────────────────────────────────────────────────────┐
│                      HTTP 캐싱 흐름                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  [클라이언트]                              [서버]                │
│      │                                        │                 │
│      │──── GET /image.png ────────────────▶  │                 │
│      │                                        │                 │
│      │◀─── 200 OK ──────────────────────────│                 │
│      │     Cache-Control: max-age=3600       │                 │
│      │     ETag: "abc123"                    │                 │
│      │     Last-Modified: Mon, 01 Jan...     │                 │
│      │                                        │                 │
│  [캐시 저장]                                  │                 │
│      │                                        │                 │
│      │──── GET /image.png ────────────────▶  │                 │
│      │     If-None-Match: "abc123"           │                 │
│      │                                        │                 │
│      │◀─── 304 Not Modified ────────────────│                 │
│      │     (바디 없음, 캐시 사용)              │                 │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Cache-Control 지시자

| 지시자 | 설명 |
|--------|------|
| `no-store` | 캐시 저장 금지 |
| `no-cache` | 캐시 사용 전 검증 필요 |
| `max-age=N` | N초 동안 유효 |
| `s-maxage=N` | 공유 캐시에서 N초 유효 |
| `private` | 개인 캐시만 허용 |
| `public` | 공유 캐시 허용 |
| `must-revalidate` | 만료 후 반드시 검증 |

---

## 5. HTTP 버전 비교

### HTTP 버전 발전

```
┌─────────────────────────────────────────────────────────────────┐
│                    HTTP 버전 발전 과정                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  HTTP/0.9 (1991)                                               │
│  └── GET만 지원, 헤더 없음                                       │
│       │                                                         │
│       ▼                                                         │
│  HTTP/1.0 (1996)                                               │
│  └── 헤더 추가, 상태 코드, POST/HEAD                             │
│       │                                                         │
│       ▼                                                         │
│  HTTP/1.1 (1997)                                               │
│  └── 지속 연결, 파이프라이닝, Host 헤더 필수                      │
│       │                                                         │
│       ▼                                                         │
│  HTTP/2 (2015)                                                  │
│  └── 바이너리 프로토콜, 멀티플렉싱, 헤더 압축                      │
│       │                                                         │
│       ▼                                                         │
│  HTTP/3 (2022)                                                  │
│  └── QUIC (UDP 기반), 향상된 연결 설정                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### HTTP/1.1 vs HTTP/2 vs HTTP/3

| 특성 | HTTP/1.1 | HTTP/2 | HTTP/3 |
|------|----------|--------|--------|
| 프로토콜 | 텍스트 | 바이너리 | 바이너리 |
| 전송 계층 | TCP | TCP | QUIC (UDP) |
| 멀티플렉싱 | X | O | O |
| 헤더 압축 | X | HPACK | QPACK |
| 서버 푸시 | X | O | O |
| 연결당 요청 | 순차적 | 동시 다중 | 동시 다중 |
| HOL Blocking | 있음 | TCP 수준에 있음 | 없음 |

### HTTP/1.1 연결 방식

```
HTTP/1.0 (비연결)           HTTP/1.1 (지속 연결)

요청 1 ──────▶              요청 1 ──────▶
      ◀────── 응답 1              ◀────── 응답 1
[연결 종료]                  요청 2 ──────▶
요청 2 ──────▶                    ◀────── 응답 2
      ◀────── 응답 2        요청 3 ──────▶
[연결 종료]                        ◀────── 응답 3
요청 3 ──────▶              [연결 유지 후 종료]
      ◀────── 응답 3
[연결 종료]

※ 3번의 TCP 연결           ※ 1번의 TCP 연결
```

### HTTP/2 멀티플렉싱

```
┌─────────────────────────────────────────────────────────────────┐
│                      HTTP/2 멀티플렉싱                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  HTTP/1.1 (순차 처리)      │  HTTP/2 (동시 처리)                 │
│                           │                                     │
│  요청1 ──────────────▶    │  요청1 ────▶                        │
│  응답1 ◀──────────────    │  요청2 ────▶ (동시)                 │
│  요청2 ──────────────▶    │  요청3 ────▶ (동시)                 │
│  응답2 ◀──────────────    │  응답2 ◀────                        │
│  요청3 ──────────────▶    │  응답1 ◀────                        │
│  응답3 ◀──────────────    │  응답3 ◀────                        │
│                           │                                     │
│  ├────────────────────┤   │  ├──────────────┤                   │
│       긴 시간              │     짧은 시간                        │
│                           │                                     │
└─────────────────────────────────────────────────────────────────┘
```

### HTTP/3와 QUIC

```
┌─────────────────────────────────────────────────────────────────┐
│                    HTTP/3 (QUIC 기반)                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐      ┌─────────────┐                           │
│  │  HTTP/2     │      │  HTTP/3     │                           │
│  ├─────────────┤      ├─────────────┤                           │
│  │    TLS      │      │    QUIC     │◀─ TLS 1.3 내장            │
│  ├─────────────┤      │   (암호화)   │                           │
│  │    TCP      │      ├─────────────┤                           │
│  ├─────────────┤      │    UDP      │                           │
│  │    IP       │      ├─────────────┤                           │
│  └─────────────┘      │    IP       │                           │
│                       └─────────────┘                           │
│                                                                 │
│  QUIC 장점:                                                     │
│  - 0-RTT 연결 (재연결 시)                                        │
│  - 패킷 손실 시 다른 스트림 영향 없음                              │
│  - 연결 마이그레이션 (IP 변경 시에도 연결 유지)                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. HTTPS와 TLS/SSL

### HTTPS 개요

```
┌─────────────────────────────────────────────────────────────────┐
│                    HTTP vs HTTPS                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  HTTP (Port 80)           │  HTTPS (Port 443)                   │
│                           │                                     │
│  ┌─────────────┐          │  ┌─────────────┐                    │
│  │    HTTP     │          │  │    HTTP     │                    │
│  ├─────────────┤          │  ├─────────────┤                    │
│  │    TCP      │          │  │  TLS/SSL    │◀─ 암호화 계층       │
│  ├─────────────┤          │  ├─────────────┤                    │
│  │    IP       │          │  │    TCP      │                    │
│  └─────────────┘          │  ├─────────────┤                    │
│                           │  │    IP       │                    │
│  평문 전송                 │  └─────────────┘                    │
│  데이터 노출 위험          │                                     │
│                           │  암호화된 전송                       │
│                           │  데이터 보호                         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### TLS/SSL 역사

| 버전 | 연도 | 상태 |
|------|------|------|
| SSL 2.0 | 1995 | 폐기 (보안 취약) |
| SSL 3.0 | 1996 | 폐기 (POODLE 취약점) |
| TLS 1.0 | 1999 | 폐기 권장 |
| TLS 1.1 | 2006 | 폐기 권장 |
| TLS 1.2 | 2008 | 사용 중 |
| TLS 1.3 | 2018 | 권장 (현재 최신) |

### TLS 핸드셰이크 (TLS 1.2)

```
┌─────────────────────────────────────────────────────────────────┐
│                  TLS 1.2 핸드셰이크                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  [클라이언트]                              [서버]                │
│      │                                        │                 │
│      │──(1) ClientHello ─────────────────▶  │                 │
│      │    - 지원 TLS 버전                     │                 │
│      │    - 지원 암호화 스위트                 │                 │
│      │    - 클라이언트 난수                   │                 │
│      │                                        │                 │
│      │◀─(2) ServerHello ─────────────────── │                 │
│      │    - 선택된 TLS 버전                   │                 │
│      │    - 선택된 암호화 스위트               │                 │
│      │    - 서버 난수                         │                 │
│      │                                        │                 │
│      │◀─(3) Certificate ─────────────────── │                 │
│      │    - 서버 인증서 (공개키 포함)          │                 │
│      │                                        │                 │
│      │◀─(4) ServerHelloDone ──────────────  │                 │
│      │                                        │                 │
│      │──(5) ClientKeyExchange ───────────▶  │                 │
│      │    - Pre-Master Secret (암호화)        │                 │
│      │                                        │                 │
│      │──(6) ChangeCipherSpec ────────────▶  │                 │
│      │──(7) Finished ────────────────────▶  │                 │
│      │                                        │                 │
│      │◀─(8) ChangeCipherSpec ───────────────│                 │
│      │◀─(9) Finished ───────────────────────│                 │
│      │                                        │                 │
│      │◀════════ 암호화된 통신 ═══════════════▶│                 │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### TLS 1.3 핸드셰이크 (간소화)

```
┌─────────────────────────────────────────────────────────────────┐
│               TLS 1.3 핸드셰이크 (1-RTT)                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  [클라이언트]                              [서버]                │
│      │                                        │                 │
│      │──(1) ClientHello + KeyShare ──────▶  │                 │
│      │                                        │                 │
│      │◀─(2) ServerHello + KeyShare ─────────│                 │
│      │      Certificate                      │                 │
│      │      Finished                         │                 │
│      │                                        │                 │
│      │──(3) Finished ────────────────────▶  │                 │
│      │                                        │                 │
│      │◀════════ 암호화된 통신 ═══════════════▶│                 │
│                                                                 │
│  ※ 1 RTT (왕복)만에 핸드셰이크 완료                              │
│  ※ 0-RTT: 이전 세션 재개 시 첫 요청부터 데이터 전송 가능           │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 암호화 종류

```
┌─────────────────────────────────────────────────────────────────┐
│                      암호화 방식                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  대칭키 암호화 (Symmetric)                                       │
│  ─────────────────────────                                      │
│  - 같은 키로 암호화/복호화                                        │
│  - 빠른 속도                                                    │
│  - 예: AES, ChaCha20                                           │
│                                                                 │
│      평문 ──[키]──▶ 암호문 ──[키]──▶ 평문                        │
│                                                                 │
│  비대칭키 암호화 (Asymmetric)                                    │
│  ─────────────────────────                                      │
│  - 공개키/개인키 쌍 사용                                          │
│  - 느린 속도, 키 교환에 사용                                      │
│  - 예: RSA, ECDSA                                               │
│                                                                 │
│      평문 ──[공개키]──▶ 암호문 ──[개인키]──▶ 평문                 │
│                                                                 │
│  TLS에서의 활용                                                  │
│  ─────────────                                                  │
│  1. 비대칭키로 세션 키 교환                                       │
│  2. 대칭키(세션 키)로 실제 데이터 암호화                           │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 7. 인증서

### 인증서 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                    X.509 인증서 구조                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  버전 (Version): V3                                      │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │  일련번호 (Serial Number): 0x1234...                     │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │  서명 알고리즘 (Signature Algorithm): SHA256withRSA      │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │  발급자 (Issuer): CN=Let's Encrypt Authority X3         │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │  유효 기간 (Validity)                                    │   │
│  │    Not Before: 2026-01-01 00:00:00                      │   │
│  │    Not After:  2026-04-01 00:00:00                      │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │  주체 (Subject): CN=www.example.com                     │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │  공개키 정보 (Public Key Info)                           │   │
│  │    Algorithm: RSA                                        │   │
│  │    Key Size: 2048 bits                                   │   │
│  │    Public Key: 30 82 01 0a 02 82 01 01 00...            │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │  확장 (Extensions)                                       │   │
│  │    Subject Alternative Names: www.example.com,           │   │
│  │                               example.com                │   │
│  │    Key Usage: Digital Signature, Key Encipherment        │   │
│  ├─────────────────────────────────────────────────────────┤   │
│  │  서명 (Signature): 48 46 2b 88 2d...                     │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 인증서 체인

```
┌─────────────────────────────────────────────────────────────────┐
│                    인증서 체인 (Chain of Trust)                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │              루트 인증서 (Root CA)                        │   │
│  │         - 자체 서명 (Self-signed)                        │   │
│  │         - 브라우저/OS에 내장                              │   │
│  │         - 예: DigiCert, GlobalSign                       │   │
│  └────────────────────────┬────────────────────────────────┘   │
│                           │ 서명                                │
│                           ▼                                     │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │           중간 인증서 (Intermediate CA)                   │   │
│  │         - 루트 CA가 서명                                  │   │
│  │         - 예: Let's Encrypt R3                           │   │
│  └────────────────────────┬────────────────────────────────┘   │
│                           │ 서명                                │
│                           ▼                                     │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │             서버 인증서 (End-Entity)                      │   │
│  │         - 중간 CA가 서명                                  │   │
│  │         - 도메인: www.example.com                        │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  검증 순서: 서버 인증서 → 중간 인증서 → 루트 인증서 (신뢰 확인)    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 인증서 종류

| 종류 | 검증 수준 | 발급 시간 | 용도 |
|------|----------|----------|------|
| DV (Domain Validation) | 도메인 소유권만 | 몇 분 | 개인, 블로그 |
| OV (Organization Validation) | 조직 검증 | 1-3일 | 기업, 기관 |
| EV (Extended Validation) | 엄격한 검증 | 1-2주 | 금융, 대기업 |
| Wildcard | 서브도메인 포함 | 다양 | *.example.com |
| Multi-Domain (SAN) | 여러 도메인 | 다양 | 여러 도메인 |

### 인증서 발급 과정 (Let's Encrypt)

```bash
# Certbot 설치 (Ubuntu)
sudo apt install certbot python3-certbot-nginx

# 인증서 발급 (Nginx)
sudo certbot --nginx -d example.com -d www.example.com

# 인증서 발급 (Apache)
sudo certbot --apache -d example.com

# 인증서 갱신
sudo certbot renew

# 인증서 확인
sudo certbot certificates

# 자동 갱신 (cron)
0 12 * * * /usr/bin/certbot renew --quiet
```

### 인증서 확인 명령어

```bash
# 도메인 인증서 확인
openssl s_client -connect example.com:443 -servername example.com

# 인증서 상세 정보
echo | openssl s_client -connect example.com:443 2>/dev/null | \
  openssl x509 -noout -text

# 만료일 확인
echo | openssl s_client -connect example.com:443 2>/dev/null | \
  openssl x509 -noout -enddate

# 로컬 인증서 파일 확인
openssl x509 -in certificate.crt -text -noout
```

---

## 8. 연습 문제

### 기초 문제

1. **HTTP 메서드**
   - GET과 POST의 차이점 3가지를 설명하세요.
   - 멱등성(Idempotent)이란 무엇이며, 멱등한 메서드를 모두 나열하세요.

2. **상태 코드**
   - 다음 상황에 적절한 상태 코드를 선택하세요:
     - 사용자 로그인 실패 (인증 실패)
     - 페이지를 찾을 수 없음
     - 서버 내부 오류 발생
     - POST 요청으로 리소스 생성 성공

3. **헤더**
   - Cache-Control: no-cache와 no-store의 차이는?
   - ETag 헤더의 용도는 무엇인가요?

### 중급 문제

4. **HTTP 버전**
   - HTTP/1.1의 HOL(Head-of-Line) Blocking 문제를 설명하세요.
   - HTTP/2가 이 문제를 어떻게 해결하나요?

5. **HTTPS/TLS**
   - HTTPS를 사용하면 얻을 수 있는 보안 이점 3가지는?
   - TLS 1.2와 TLS 1.3의 핸드셰이크 RTT 차이는?

6. **실습 문제**

```bash
# 다음 curl 명령어의 결과를 분석하세요

# 1. 요청 헤더에 무엇이 포함되어 있나요?
curl -v http://example.com

# 2. 이 요청이 성공하면 어떤 상태 코드를 받나요?
curl -I -X DELETE http://api.example.com/users/1

# 3. 이 요청에서 Content-Type은 무엇인가요?
curl -X POST http://api.example.com/users \
  -H "Content-Type: application/json" \
  -d '{"name": "test"}'
```

### 고급 문제

7. **인증서 체인**
   - 루트 CA가 직접 서버 인증서에 서명하지 않고 중간 CA를 사용하는 이유는?

8. **보안 헤더**
   - 다음 보안 취약점을 방지하기 위한 HTTP 헤더를 제시하세요:
     - 클릭재킹 (Clickjacking)
     - XSS (Cross-Site Scripting)
     - MIME 스니핑

---

## 9. 다음 단계

[14_Other_Application_Protocols.md](./14_Other_Application_Protocols.md)에서 DHCP, FTP, SMTP, SSH 등 다른 애플리케이션 계층 프로토콜을 배워봅시다!

---

## 10. 참고 자료

### RFC 문서

- [RFC 7230-7235](https://tools.ietf.org/html/rfc7230) - HTTP/1.1
- [RFC 7540](https://tools.ietf.org/html/rfc7540) - HTTP/2
- [RFC 9110-9114](https://tools.ietf.org/html/rfc9110) - HTTP Semantics
- [RFC 8446](https://tools.ietf.org/html/rfc8446) - TLS 1.3

### 온라인 자료

- [MDN HTTP 문서](https://developer.mozilla.org/ko/docs/Web/HTTP)
- [HTTP 상태 코드](https://httpstatuses.com/)
- [SSL Labs Server Test](https://www.ssllabs.com/ssltest/)
- [Let's Encrypt 문서](https://letsencrypt.org/docs/)

### 도구

- curl - 명령줄 HTTP 클라이언트
- Postman - API 테스트 도구
- Charles Proxy - HTTP 프록시/모니터링
- Wireshark - 패킷 분석
