# 서브네팅 실습

## 개요

이 문서에서는 서브네팅(Subnetting)의 실제 계산 방법과 다양한 실습 문제를 다룹니다. 서브네팅은 네트워크 설계와 관리의 핵심 기술로, 효율적인 IP 주소 할당과 네트워크 분할을 가능하게 합니다.

**난이도**: ⭐⭐⭐
**예상 학습 시간**: 3-4시간
**선수 지식**: [06_IP_Address_Subnetting.md](./06_IP_Address_Subnetting.md)

---

## 목차

1. [서브넷 계산 기초](#1-서브넷-계산-기초)
2. [네트워크 주소, 브로드캐스트 주소, 호스트 범위](#2-네트워크-주소-브로드캐스트-주소-호스트-범위)
3. [서브넷 분할 예제](#3-서브넷-분할-예제)
4. [VLSM (Variable Length Subnet Mask)](#4-vlsm-variable-length-subnet-mask)
5. [서브넷 설계 문제](#5-서브넷-설계-문제)
6. [연습 문제](#6-연습-문제)
7. [다음 단계](#7-다음-단계)
8. [참고 자료](#8-참고-자료)

---

## 1. 서브넷 계산 기초

### 1.1 2의 거듭제곱 암기

서브네팅을 빠르게 계산하려면 2의 거듭제곱을 암기해야 합니다.

```
2^0 = 1        2^5 = 32       2^10 = 1,024
2^1 = 2        2^6 = 64       2^11 = 2,048
2^2 = 4        2^7 = 128      2^12 = 4,096
2^3 = 8        2^8 = 256      2^13 = 8,192
2^4 = 16       2^9 = 512      2^14 = 16,384
```

### 1.2 서브넷 마스크와 CIDR 표기

| CIDR | 서브넷 마스크     | 호스트 비트 | 사용 가능 호스트 |
|------|------------------|------------|-----------------|
| /24  | 255.255.255.0    | 8          | 254             |
| /25  | 255.255.255.128  | 7          | 126             |
| /26  | 255.255.255.192  | 6          | 62              |
| /27  | 255.255.255.224  | 5          | 30              |
| /28  | 255.255.255.240  | 4          | 14              |
| /29  | 255.255.255.248  | 3          | 6               |
| /30  | 255.255.255.252  | 2          | 2               |
| /31  | 255.255.255.254  | 1          | 2 (Point-to-Point) |
| /32  | 255.255.255.255  | 0          | 1 (호스트 라우트) |

### 1.3 마법의 숫자 (Magic Number)

마법의 숫자는 서브넷의 크기를 나타내며, 계산을 빠르게 합니다.

```
마법의 숫자 = 256 - 서브넷 마스크의 마지막 옥텟 값
```

| 서브넷 마스크 | 마법의 숫자 | CIDR |
|--------------|------------|------|
| 255.255.255.0   | 256     | /24  |
| 255.255.255.128 | 128     | /25  |
| 255.255.255.192 | 64      | /26  |
| 255.255.255.224 | 32      | /27  |
| 255.255.255.240 | 16      | /28  |
| 255.255.255.248 | 8       | /29  |
| 255.255.255.252 | 4       | /30  |

### 1.4 서브넷 계산 공식

```
서브넷 수 = 2^(서브넷 비트 수)
호스트 수 = 2^(호스트 비트 수) - 2
블록 크기 = 256 - 서브넷 마스크 값 (마지막 옥텟)
```

---

## 2. 네트워크 주소, 브로드캐스트 주소, 호스트 범위

### 2.1 핵심 개념

```
┌─────────────────────────────────────────────────────────────┐
│                      192.168.1.0/24                         │
├─────────────────────────────────────────────────────────────┤
│  네트워크 주소     : 192.168.1.0     (모든 호스트 비트 = 0) │
│  첫 번째 호스트    : 192.168.1.1                            │
│  마지막 호스트     : 192.168.1.254                          │
│  브로드캐스트 주소 : 192.168.1.255   (모든 호스트 비트 = 1) │
│  사용 가능 호스트  : 254개                                  │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 계산 방법

**예제: 192.168.1.100/26의 네트워크 정보 계산**

**Step 1: 서브넷 마스크 확인**
```
/26 = 255.255.255.192
이진수: 11111111.11111111.11111111.11000000
```

**Step 2: 블록 크기 계산**
```
블록 크기 = 256 - 192 = 64
```

**Step 3: 네트워크 주소 찾기**
```
IP의 마지막 옥텟: 100
100 ÷ 64 = 1 (나머지 36)
네트워크 시작: 1 × 64 = 64
네트워크 주소: 192.168.1.64
```

**Step 4: 브로드캐스트 주소 계산**
```
브로드캐스트 = 네트워크 주소 + 블록 크기 - 1
            = 64 + 64 - 1 = 127
브로드캐스트 주소: 192.168.1.127
```

**Step 5: 호스트 범위 결정**
```
첫 번째 호스트: 192.168.1.65
마지막 호스트: 192.168.1.126
사용 가능 호스트: 62개 (2^6 - 2)
```

### 2.3 시각적 이해

```
192.168.1.0/26 네트워크의 서브넷 분할

┌─────────────────────────────────────────────────────────┐
│                    192.168.1.0/24                       │
├─────────────────────────────────────────────────────────┤
│ 서브넷 1       │ 서브넷 2       │ 서브넷 3       │ 서브넷 4       │
│ .0 - .63      │ .64 - .127    │ .128 - .191   │ .192 - .255   │
│ /26           │ /26           │ /26           │ /26           │
│               │               │               │               │
│ 네트워크: .0  │ 네트워크: .64 │ 네트워크: .128│ 네트워크: .192│
│ 호스트:       │ 호스트:       │ 호스트:       │ 호스트:       │
│ .1 - .62      │ .65 - .126    │ .129 - .190   │ .193 - .254   │
│ 브로드:.63    │ 브로드:.127   │ 브로드:.191   │ 브로드:.255   │
└─────────────────────────────────────────────────────────┘
```

### 2.4 이진수로 계산하기

```
IP 주소:      192.168.1.100 = 11000000.10101000.00000001.01100100
서브넷 마스크: 255.255.255.192 = 11111111.11111111.11111111.11000000
                                                          ↑↑
                                                    네트워크 비트

AND 연산 (네트워크 주소):
  11000000.10101000.00000001.01100100  (IP)
& 11111111.11111111.11111111.11000000  (마스크)
= 11000000.10101000.00000001.01000000  = 192.168.1.64

OR 연산 (브로드캐스트 주소):
  11000000.10101000.00000001.01000000  (네트워크)
| 00000000.00000000.00000000.00111111  (와일드카드)
= 11000000.10101000.00000001.01111111  = 192.168.1.127
```

---

## 3. 서브넷 분할 예제

### 3.1 /24 네트워크를 4개로 분할

**문제**: 10.0.0.0/24를 4개의 동일한 서브넷으로 분할

**풀이**:
```
4개의 서브넷 = 2^2 → 서브넷 비트 2개 추가 필요
새로운 CIDR: /24 + 2 = /26
각 서브넷 호스트: 2^6 - 2 = 62개
```

**결과**:

| 서브넷 | 네트워크 주소  | 호스트 범위          | 브로드캐스트    |
|--------|---------------|---------------------|----------------|
| 1      | 10.0.0.0/26   | 10.0.0.1 - 62       | 10.0.0.63      |
| 2      | 10.0.0.64/26  | 10.0.0.65 - 126     | 10.0.0.127     |
| 3      | 10.0.0.128/26 | 10.0.0.129 - 190    | 10.0.0.191     |
| 4      | 10.0.0.192/26 | 10.0.0.193 - 254    | 10.0.0.255     |

### 3.2 /16 네트워크를 16개로 분할

**문제**: 172.16.0.0/16을 16개의 서브넷으로 분할

**풀이**:
```
16개의 서브넷 = 2^4 → 서브넷 비트 4개 추가
새로운 CIDR: /16 + 4 = /20
각 서브넷 호스트: 2^12 - 2 = 4,094개
블록 크기: 256 - 240 = 16 (세 번째 옥텟에서)
```

**결과**:

| 서브넷 | 네트워크 주소      | 호스트 범위                    |
|--------|-------------------|-------------------------------|
| 1      | 172.16.0.0/20     | 172.16.0.1 - 172.16.15.254    |
| 2      | 172.16.16.0/20    | 172.16.16.1 - 172.16.31.254   |
| 3      | 172.16.32.0/20    | 172.16.32.1 - 172.16.47.254   |
| 4      | 172.16.48.0/20    | 172.16.48.1 - 172.16.63.254   |
| ...    | ...               | ...                            |
| 16     | 172.16.240.0/20   | 172.16.240.1 - 172.16.255.254 |

### 3.3 특정 호스트 수에 맞춘 서브넷

**문제**: 192.168.10.0/24에서 50개 호스트를 지원하는 서브넷 필요

**풀이**:
```
50개 호스트 지원 필요
2^5 - 2 = 30 (부족)
2^6 - 2 = 62 (충분)

호스트 비트: 6개
CIDR: /26
서브넷 마스크: 255.255.255.192
```

---

## 4. VLSM (Variable Length Subnet Mask)

### 4.1 VLSM이란?

VLSM은 서로 다른 크기의 서브넷을 사용하여 IP 주소를 효율적으로 할당하는 기법입니다.

```
전통적 서브네팅 (동일 크기)          VLSM (가변 크기)

┌─────────┬─────────┐           ┌─────────────────┐
│ /26     │ /26     │           │     /25         │
│ 62 host │ 62 host │           │   126 host      │
├─────────┼─────────┤           ├────────┬────────┤
│ /26     │ /26     │           │ /27    │ /27    │
│ 62 host │ 62 host │           │30 host │30 host │
└─────────┴─────────┘           ├───┬────┴────────┤
                                │/30│   /28       │
IP 낭비 많음                    │2  │   14 host   │
                                └───┴─────────────┘
                                IP 효율적 사용
```

### 4.2 VLSM 설계 원칙

1. **큰 서브넷부터 할당**: 가장 많은 호스트가 필요한 네트워크부터 시작
2. **2의 거듭제곱 활용**: 각 서브넷 크기는 2^n - 2
3. **연속 주소 사용**: 주소 공간을 연속으로 유지

### 4.3 VLSM 설계 예제

**시나리오**: 172.20.0.0/22를 다음 요구사항에 맞게 분할

| 부서         | 필요 호스트 수 |
|-------------|---------------|
| 영업부       | 200           |
| 개발부       | 100           |
| 인사부       | 50            |
| 경영지원부   | 20            |
| WAN 링크 1  | 2             |
| WAN 링크 2  | 2             |

**Step 1: 크기순 정렬 및 서브넷 결정**

| 부서         | 호스트 | 필요 비트 | 서브넷 | 실제 호스트 |
|-------------|-------|----------|--------|------------|
| 영업부       | 200   | 8        | /24    | 254        |
| 개발부       | 100   | 7        | /25    | 126        |
| 인사부       | 50    | 6        | /26    | 62         |
| 경영지원부   | 20    | 5        | /27    | 30         |
| WAN 링크 1  | 2     | 2        | /30    | 2          |
| WAN 링크 2  | 2     | 2        | /30    | 2          |

**Step 2: 주소 할당**

```
172.20.0.0/22 (1,022 사용 가능 호스트)
│
├─ 영업부: 172.20.0.0/24
│   ├─ 네트워크: 172.20.0.0
│   ├─ 호스트: 172.20.0.1 - 172.20.0.254
│   └─ 브로드캐스트: 172.20.0.255
│
├─ 개발부: 172.20.1.0/25
│   ├─ 네트워크: 172.20.1.0
│   ├─ 호스트: 172.20.1.1 - 172.20.1.126
│   └─ 브로드캐스트: 172.20.1.127
│
├─ 인사부: 172.20.1.128/26
│   ├─ 네트워크: 172.20.1.128
│   ├─ 호스트: 172.20.1.129 - 172.20.1.190
│   └─ 브로드캐스트: 172.20.1.191
│
├─ 경영지원부: 172.20.1.192/27
│   ├─ 네트워크: 172.20.1.192
│   ├─ 호스트: 172.20.1.193 - 172.20.1.222
│   └─ 브로드캐스트: 172.20.1.223
│
├─ WAN 링크 1: 172.20.1.224/30
│   ├─ 네트워크: 172.20.1.224
│   ├─ 호스트: 172.20.1.225 - 172.20.1.226
│   └─ 브로드캐스트: 172.20.1.227
│
└─ WAN 링크 2: 172.20.1.228/30
    ├─ 네트워크: 172.20.1.228
    ├─ 호스트: 172.20.1.229 - 172.20.1.230
    └─ 브로드캐스트: 172.20.1.231
```

**Step 3: 주소 사용 현황**

```
172.20.0.0/22 주소 맵

       .0         .64        .128       .192       .255
        ├──────────┼──────────┼──────────┼──────────┤
   .0   │                  영업부 /24                 │
        ├─────────────────────┼──────────┼────┬─────┤
   .1   │      개발부 /25     │ 인사부   │경영│ WAN │
        │                     │  /26     │/27 │/30  │
        └─────────────────────┴──────────┴────┴─────┘
   .2   │              (예약됨)                      │
        ├────────────────────────────────────────────┤
   .3   │              (예약됨)                      │
        └────────────────────────────────────────────┘
```

### 4.4 VLSM의 장단점

**장점**:
- IP 주소 효율적 사용
- 네트워크 크기에 맞는 유연한 할당
- 라우팅 테이블 축약 가능

**단점**:
- 설계 복잡성 증가
- 실수 시 주소 중복 가능
- 모든 라우터가 VLSM 지원 필요

---

## 5. 서브넷 설계 문제

### 5.1 소규모 사무실 설계

**요구사항**:
- 공인 IP: 203.0.113.0/28
- 네트워크: 웹 서버(3대), 내부 서버(5대), 관리용(2대)

**설계**:
```
203.0.113.0/28 (14개 호스트 사용 가능)
│
├─ 웹 서버: 203.0.113.1 - 203.0.113.3
├─ 내부 서버: 203.0.113.4 - 203.0.113.8
├─ 관리용: 203.0.113.9 - 203.0.113.10
├─ 예약: 203.0.113.11 - 203.0.113.13
└─ 게이트웨이: 203.0.113.14 (마지막 호스트)
```

### 5.2 중규모 기업 네트워크

**요구사항**:
- 네트워크: 10.100.0.0/16
- 본사: 1,000명
- 지사 A: 200명
- 지사 B: 150명
- 데이터센터: 500대 서버
- 향후 확장 고려

**VLSM 설계**:

| 구역         | 서브넷          | 호스트 범위                    | 용량  |
|-------------|----------------|-------------------------------|-------|
| 본사         | 10.100.0.0/22  | 10.100.0.1 - 10.100.3.254     | 1,022 |
| 데이터센터   | 10.100.4.0/23  | 10.100.4.1 - 10.100.5.254     | 510   |
| 지사 A       | 10.100.6.0/24  | 10.100.6.1 - 10.100.6.254     | 254   |
| 지사 B       | 10.100.7.0/24  | 10.100.7.1 - 10.100.7.254     | 254   |
| 관리 VLAN    | 10.100.8.0/26  | 10.100.8.1 - 10.100.8.62      | 62    |
| WAN 링크     | 10.100.8.64/30 | 10.100.8.65 - 10.100.8.66     | 2     |
| 예약         | 10.100.9.0/24+ | -                             | -     |

### 5.3 네트워크 다이어그램

```
                    ┌─────────────┐
                    │   Internet  │
                    └──────┬──────┘
                           │
                    ┌──────┴──────┐
                    │  Edge Router │
                    │ 10.100.8.65 │
                    └──────┬──────┘
              WAN Link /30 │ 10.100.8.64/30
                    ┌──────┴──────┐
                    │ Core Switch │
                    │ 10.100.8.1  │
                    └──────┬──────┘
            ┌──────────────┼──────────────┐
            │              │              │
     ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐
     │   본사      ││ 데이터센터  ││   지사 A    │
     │10.100.0.0/22││10.100.4.0/23││10.100.6.0/24│
     │ 1,022 hosts ││  510 hosts  ││  254 hosts  │
     └─────────────┘└─────────────┘└─────────────┘
```

---

## 6. 연습 문제

### 문제 1: 기본 서브넷 계산

다음 IP 주소의 네트워크 정보를 계산하세요.

**a) 192.168.50.100/27**
```
네트워크 주소: ____________
브로드캐스트 주소: ____________
호스트 범위: ____________
사용 가능 호스트 수: ____________
```

**b) 10.20.30.200/21**
```
네트워크 주소: ____________
브로드캐스트 주소: ____________
호스트 범위: ____________
사용 가능 호스트 수: ____________
```

**c) 172.31.128.50/18**
```
네트워크 주소: ____________
브로드캐스트 주소: ____________
호스트 범위: ____________
사용 가능 호스트 수: ____________
```

### 문제 2: 서브넷 분할

**a)** 192.168.100.0/24를 8개의 동일한 서브넷으로 분할하세요.

| 서브넷 | 네트워크 주소 | 호스트 범위 | 브로드캐스트 |
|--------|--------------|------------|-------------|
| 1      |              |            |             |
| 2      |              |            |             |
| 3      |              |            |             |
| 4      |              |            |             |
| 5      |              |            |             |
| 6      |              |            |             |
| 7      |              |            |             |
| 8      |              |            |             |

**b)** 10.0.0.0/8에서 각각 16,000개 호스트를 지원하는 서브넷을 몇 개 만들 수 있나요?

### 문제 3: VLSM 설계

**시나리오**: 172.30.0.0/23을 다음 요구사항에 맞게 분할하세요.

| 네트워크      | 필요 호스트 |
|--------------|------------|
| LAN A        | 120        |
| LAN B        | 60         |
| LAN C        | 30         |
| LAN D        | 10         |
| WAN 링크 1   | 2          |
| WAN 링크 2   | 2          |

설계 결과:

| 네트워크     | 서브넷 | 네트워크 주소 | 호스트 범위 | 브로드캐스트 |
|-------------|-------|--------------|------------|-------------|
| LAN A       |       |              |            |             |
| LAN B       |       |              |            |             |
| LAN C       |       |              |            |             |
| LAN D       |       |              |            |             |
| WAN 링크 1  |       |              |            |             |
| WAN 링크 2  |       |              |            |             |

### 문제 4: 네트워크 설계 종합

**시나리오**: 당신은 새로운 회사의 네트워크를 설계해야 합니다.

- 할당된 네트워크: 10.50.0.0/20
- 요구사항:
  - 영업부: 500명
  - 기술부: 250명
  - 관리부: 100명
  - 서버팜: 60대
  - DMZ: 20대
  - 향후 3년간 30% 성장 예상

각 부서에 적절한 서브넷을 할당하고, 미래 확장을 고려한 설계를 하세요.

---

## 정답

### 문제 1 정답

**a) 192.168.50.100/27**
```
블록 크기: 256 - 224 = 32
100 ÷ 32 = 3 (나머지 4) → 시작: 96
네트워크 주소: 192.168.50.96
브로드캐스트 주소: 192.168.50.127
호스트 범위: 192.168.50.97 - 192.168.50.126
사용 가능 호스트 수: 30개
```

**b) 10.20.30.200/21**
```
/21 = 세 번째 옥텟에서 5비트 네트워크, 3비트 + 8비트 호스트
블록 크기(3rd 옥텟): 8
30 ÷ 8 = 3 (나머지 6) → 시작: 24
네트워크 주소: 10.20.24.0
브로드캐스트 주소: 10.20.31.255
호스트 범위: 10.20.24.1 - 10.20.31.254
사용 가능 호스트 수: 2,046개
```

**c) 172.31.128.50/18**
```
/18 = 두 번째 옥텟에서 2비트 네트워크
블록 크기(2nd 옥텟): 64
128 ÷ 64 = 2 → 시작: 128
네트워크 주소: 172.31.128.0
브로드캐스트 주소: 172.31.191.255
호스트 범위: 172.31.128.1 - 172.31.191.254
사용 가능 호스트 수: 16,382개
```

### 문제 2 정답

**a) 8개 서브넷 분할**
```
8 = 2^3 → 3비트 추가 필요
/24 + 3 = /27 (블록 크기: 32)
```

| 서브넷 | 네트워크 주소        | 호스트 범위       | 브로드캐스트       |
|--------|---------------------|-------------------|-------------------|
| 1      | 192.168.100.0/27    | .1 - .30          | 192.168.100.31    |
| 2      | 192.168.100.32/27   | .33 - .62         | 192.168.100.63    |
| 3      | 192.168.100.64/27   | .65 - .94         | 192.168.100.95    |
| 4      | 192.168.100.96/27   | .97 - .126        | 192.168.100.127   |
| 5      | 192.168.100.128/27  | .129 - .158       | 192.168.100.159   |
| 6      | 192.168.100.160/27  | .161 - .190       | 192.168.100.191   |
| 7      | 192.168.100.192/27  | .193 - .222       | 192.168.100.223   |
| 8      | 192.168.100.224/27  | .225 - .254       | 192.168.100.255   |

**b) 16,000 호스트 서브넷**
```
16,000 호스트 → 2^14 = 16,384 필요 → 14비트 호스트
CIDR: 32 - 14 = /18
10.0.0.0/8 → /18 서브넷 수: 2^(18-8) = 2^10 = 1,024개
```

### 문제 3 정답 (VLSM)

| 네트워크    | 서브넷 | 네트워크 주소    | 호스트 범위               | 브로드캐스트    |
|------------|-------|-----------------|--------------------------|----------------|
| LAN A      | /25   | 172.30.0.0/25   | 172.30.0.1 - .126        | 172.30.0.127   |
| LAN B      | /26   | 172.30.0.128/26 | 172.30.0.129 - .190      | 172.30.0.191   |
| LAN C      | /27   | 172.30.0.192/27 | 172.30.0.193 - .222      | 172.30.0.223   |
| LAN D      | /28   | 172.30.0.224/28 | 172.30.0.225 - .238      | 172.30.0.239   |
| WAN 링크 1 | /30   | 172.30.0.240/30 | 172.30.0.241 - .242      | 172.30.0.243   |
| WAN 링크 2 | /30   | 172.30.0.244/30 | 172.30.0.245 - .246      | 172.30.0.247   |

---

## 7. 다음 단계

서브네팅을 충분히 연습했다면, 다음 주제로 넘어가세요.

### 다음 레슨
- [08_Routing_Basics.md](./08_Routing_Basics.md) - 라우팅 테이블, 정적/동적 라우팅

### 관련 레슨
- [06_IP_Address_Subnetting.md](./06_IP_Address_Subnetting.md) - IP 주소 기초
- [09_Routing_Protocols.md](./09_Routing_Protocols.md) - RIP, OSPF, BGP

### 추천 실습
1. 다양한 CIDR 조합으로 서브넷 계산 연습
2. 실제 네트워크 환경에서 `ip addr`로 확인
3. Packet Tracer에서 서브넷 구성 실습

---

## 8. 참고 자료

### 온라인 도구

- [Subnet Calculator](https://www.subnet-calculator.com/)
- [Visual Subnet Calculator](https://www.davidc.net/sites/default/subnets/subnets.html)
- [IP Address Guide](https://www.ipaddressguide.com/cidr)

### 학습 자료

- RFC 950 - Internet Standard Subnetting Procedure
- RFC 1878 - Variable Length Subnet Table
- Cisco Networking Academy - Subnetting

### 명령어 참고

```bash
# Linux/macOS - 네트워크 설정 확인
ip addr show
ifconfig

# 서브넷 계산 도구
ipcalc 192.168.1.0/24      # Linux
sipcalc 192.168.1.0/24     # Linux

# Windows
ipconfig /all
```

---

**문서 정보**
- 최종 수정: 2024년
- 난이도: ⭐⭐⭐
- 예상 학습 시간: 3-4시간
