# TCP/IP 모델

## 개요

TCP/IP(Transmission Control Protocol/Internet Protocol) 모델은 인터넷의 기초가 되는 프로토콜 스택입니다. 1970년대 미국 국방부 ARPANET 프로젝트에서 개발되어 현재 전 세계 인터넷 통신의 표준으로 사용되고 있습니다. 이 레슨에서는 TCP/IP 모델의 4계층 구조, OSI 모델과의 비교, 인터넷의 역사, 그리고 실제 통신 흐름을 학습합니다.

**난이도**: ⭐⭐ (초급-중급)

---

## 목차

1. [TCP/IP 모델 개요](#1-tcpip-모델-개요)
2. [인터넷의 역사](#2-인터넷의-역사)
3. [TCP/IP 4계층](#3-tcpip-4계층)
4. [OSI와 TCP/IP 비교](#4-osi와-tcpip-비교)
5. [각 계층의 프로토콜](#5-각-계층의-프로토콜)
6. [실제 통신 흐름](#6-실제-통신-흐름)
7. [TCP vs UDP](#7-tcp-vs-udp)
8. [연습 문제](#8-연습-문제)

---

## 1. TCP/IP 모델 개요

### TCP/IP란?

```
┌─────────────────────────────────────────────────────────────────┐
│                    TCP/IP 프로토콜 스택                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   TCP/IP (Transmission Control Protocol / Internet Protocol)    │
│                                                                  │
│   "인터넷에서 컴퓨터들이 서로 정보를 주고받는 데 쓰이는         │
│    통신 규약(프로토콜)의 모음"                                  │
│                                                                  │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │  TCP (Transmission Control Protocol)                    │   │
│   │  └── 신뢰성 있는 데이터 전송 보장                       │   │
│   │  └── 연결 지향, 흐름 제어, 오류 복구                    │   │
│   │                                                          │   │
│   │  IP (Internet Protocol)                                 │   │
│   │  └── 패킷의 주소 지정과 라우팅                          │   │
│   │  └── 비연결, 최선형 전달 (Best-effort)                  │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   특징:                                                         │
│   - 실용적인 구현 중심 모델                                     │
│   - 계층 간 경계가 유연함                                       │
│   - 인터넷의 사실상 표준 (de facto standard)                    │
│   - 개방형 표준 (RFC 문서로 공개)                               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### TCP/IP 4계층 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                     TCP/IP 4계층 모델                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   계층 번호    계층 이름              주요 역할                 │
│   ────────────────────────────────────────────────────────────  │
│                                                                  │
│     ┌─────────────────────────────────────────────────────┐     │
│   4 │           응용 계층 (Application Layer)              │     │
│     │      HTTP, FTP, SMTP, DNS, SSH, Telnet              │     │
│     │      사용자 애플리케이션과 네트워크 인터페이스       │     │
│     ├─────────────────────────────────────────────────────┤     │
│   3 │           전송 계층 (Transport Layer)                │     │
│     │      TCP, UDP                                        │     │
│     │      종단 간 통신, 신뢰성/비신뢰성 전송             │     │
│     ├─────────────────────────────────────────────────────┤     │
│   2 │          인터넷 계층 (Internet Layer)                │     │
│     │      IP, ICMP, ARP, RARP                             │     │
│     │      논리적 주소 지정, 패킷 라우팅                   │     │
│     ├─────────────────────────────────────────────────────┤     │
│   1 │      네트워크 접근 계층 (Network Access Layer)       │     │
│     │      이더넷, Wi-Fi, PPP                              │     │
│     │      물리적 전송, 프레임 전송                        │     │
│     └─────────────────────────────────────────────────────┘     │
│                                                                  │
│   * 일부 문서에서는 5계층으로 나누기도 함                       │
│     (네트워크 접근 계층을 데이터링크 + 물리로 분리)             │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### TCP/IP의 설계 원칙

```
┌─────────────────────────────────────────────────────────────────┐
│                   TCP/IP 설계 원칙                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   1. 종단 간 원칙 (End-to-End Principle)                        │
│      ┌───────────────────────────────────────────────────┐      │
│      │  지능(복잡한 기능)은 네트워크 끝단(호스트)에 둔다  │      │
│      │  네트워크 코어(라우터)는 단순하게 유지            │      │
│      │                                                    │      │
│      │  호스트 A ─────[라우터]─────[라우터]───── 호스트 B │      │
│      │  (복잡)        (단순)       (단순)        (복잡)  │      │
│      └───────────────────────────────────────────────────┘      │
│                                                                  │
│   2. 견고성 원칙 (Robustness Principle)                         │
│      ┌───────────────────────────────────────────────────┐      │
│      │  "보내는 것은 엄격하게, 받는 것은 관대하게"        │      │
│      │  (Be conservative in what you send,               │      │
│      │   be liberal in what you accept)                  │      │
│      └───────────────────────────────────────────────────┘      │
│                                                                  │
│   3. 계층화 원칙 (Layering Principle)                           │
│      ┌───────────────────────────────────────────────────┐      │
│      │  각 계층은 독립적으로 작동                        │      │
│      │  하위 계층은 상위 계층에 서비스 제공              │      │
│      │  계층 간 인터페이스 표준화                        │      │
│      └───────────────────────────────────────────────────┘      │
│                                                                  │
│   4. 패킷 교환 원칙 (Packet Switching)                          │
│      ┌───────────────────────────────────────────────────┐      │
│      │  데이터를 작은 패킷으로 분할하여 전송             │      │
│      │  각 패킷은 독립적으로 라우팅                      │      │
│      │  네트워크 자원의 효율적 사용                      │      │
│      └───────────────────────────────────────────────────┘      │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. 인터넷의 역사

### 인터넷 발전 연표

```
┌─────────────────────────────────────────────────────────────────┐
│                     인터넷 발전 연표                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  1960년대: 개념의 시작                                          │
│  ─────────────────────────────────────────────────────────────  │
│  1962  J.C.R. Licklider의 "은하 간 네트워크" 개념               │
│  1965  최초의 WAN 연결 (MIT-UCLA)                               │
│  1969  ARPANET 시작 (4개 노드)                                  │
│        - UCLA, SRI, UCSB, Utah                                  │
│                                                                  │
│  1970년대: 프로토콜 개발                                        │
│  ─────────────────────────────────────────────────────────────  │
│  1971  이메일 발명 (Ray Tomlinson)                              │
│  1973  TCP/IP 개념 제안 (Vint Cerf, Bob Kahn)                   │
│  1974  TCP 명세 발표                                            │
│  1976  이더넷 개발 (Xerox PARC)                                 │
│                                                                  │
│  1980년대: 표준화와 확산                                        │
│  ─────────────────────────────────────────────────────────────  │
│  1981  IPv4 표준화 (RFC 791)                                    │
│  1983  TCP/IP 채택 (ARPANET), DNS 도입                          │
│        ★ 인터넷의 공식적인 시작                                 │
│  1986  NSFNET 출범 (56 Kbps 백본)                               │
│  1989  WWW 발명 (Tim Berners-Lee, CERN)                         │
│                                                                  │
│  1990년대: 상용화와 대중화                                      │
│  ─────────────────────────────────────────────────────────────  │
│  1991  WWW 공개, Gopher 등장                                    │
│  1993  Mosaic 웹 브라우저 출시                                  │
│  1994  Netscape Navigator 출시                                  │
│  1995  상용 인터넷 확산, Amazon, eBay 설립                      │
│  1998  Google 설립, IPv6 표준화                                 │
│                                                                  │
│  2000년대: 모바일과 소셜                                        │
│  ─────────────────────────────────────────────────────────────  │
│  2004  Facebook 설립, Web 2.0                                   │
│  2005  YouTube 설립                                             │
│  2007  iPhone 출시, 모바일 인터넷 대중화                        │
│                                                                  │
│  2010년대~현재: 클라우드와 IoT                                  │
│  ─────────────────────────────────────────────────────────────  │
│  2010  클라우드 컴퓨팅 확산                                     │
│  2016  IPv4 고갈, IPv6 전환 가속                                │
│  2020  5G 상용화, 초연결 시대                                   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### ARPANET에서 인터넷으로

```
┌─────────────────────────────────────────────────────────────────┐
│                 ARPANET → Internet 발전                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   1969: ARPANET 시작 (4개 노드)                                 │
│                                                                  │
│                    ┌─────┐                                      │
│                    │UCLA │                                      │
│                    └──┬──┘                                      │
│                       │                                          │
│        ┌──────────────┼──────────────┐                          │
│        │              │              │                          │
│     ┌──┴──┐       ┌───┴───┐      ┌───┴───┐                     │
│     │ SRI │       │ UCSB  │      │ Utah  │                     │
│     └─────┘       └───────┘      └───────┘                     │
│                                                                  │
│   1983: TCP/IP 전환                                             │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  NCP (Network Control Protocol) → TCP/IP                │   │
│   │                                                          │   │
│   │  - 이 전환을 "인터넷의 탄생"으로 봄                      │   │
│   │  - 이기종 네트워크 연결 가능                            │   │
│   │  - 확장성 확보                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   1990년대: 상용 인터넷                                         │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │       ARPANET     NSFNET      상용 ISP                  │   │
│   │       (군/학)  →  (학술)  →  (일반 대중)                │   │
│   │                                                          │   │
│   │   ┌─────────┐    ┌─────────┐    ┌─────────┐            │   │
│   │   │ 대학    │    │ 연구소  │    │ 가정/   │            │   │
│   │   │ 연구소  │    │ 대학    │    │ 기업    │            │   │
│   │   └─────────┘    └─────────┘    └─────────┘            │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   현재: 글로벌 인터넷                                           │
│   - 수십억 대의 장치 연결                                       │
│   - 해저 케이블로 대륙 연결                                     │
│   - IoT, 클라우드, 5G/6G                                        │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### TCP/IP 개발의 주역들

| 인물 | 기여 | 주요 성과 |
|------|------|-----------|
| Vint Cerf | TCP/IP 공동 발명 | "인터넷의 아버지" |
| Bob Kahn | TCP/IP 공동 발명 | ARPANET 설계 |
| Tim Berners-Lee | WWW 발명 | HTTP, HTML |
| Ray Tomlinson | 이메일 발명 | @ 기호 사용 |
| Bob Metcalfe | 이더넷 발명 | LAN 표준 |
| Jon Postel | 프로토콜 표준화 | RFC 편집자 |

---

## 3. TCP/IP 4계층

### 계층 4: 응용 계층 (Application Layer)

```
┌─────────────────────────────────────────────────────────────────┐
│                4계층: 응용 계층 (Application Layer)              │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   역할: 사용자와 네트워크 간 인터페이스 제공                    │
│         애플리케이션 프로토콜 구현                              │
│                                                                  │
│   OSI 모델과의 관계:                                            │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │   OSI 7계층: 응용 + 표현 + 세션                         │   │
│   │        ↓                                                 │   │
│   │   TCP/IP: 응용 계층 (하나로 통합)                       │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   주요 프로토콜:                                                │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   ┌──────────┐  ┌──────────┐  ┌──────────┐             │   │
│   │   │   HTTP   │  │   FTP    │  │   SMTP   │             │   │
│   │   │ 웹 통신  │  │파일 전송 │  │메일 전송 │             │   │
│   │   │ TCP/80   │  │ TCP/21   │  │ TCP/25   │             │   │
│   │   └──────────┘  └──────────┘  └──────────┘             │   │
│   │                                                          │   │
│   │   ┌──────────┐  ┌──────────┐  ┌──────────┐             │   │
│   │   │   DNS    │  │   SSH    │  │   DHCP   │             │   │
│   │   │이름 해석 │  │보안 접속 │  │IP 할당   │             │   │
│   │   │ UDP/53   │  │ TCP/22   │  │ UDP/67,68│             │   │
│   │   └──────────┘  └──────────┘  └──────────┘             │   │
│   │                                                          │   │
│   │   ┌──────────┐  ┌──────────┐  ┌──────────┐             │   │
│   │   │   POP3   │  │   IMAP   │  │  Telnet  │             │   │
│   │   │메일 수신 │  │메일 접근 │  │원격 접속 │             │   │
│   │   │ TCP/110  │  │ TCP/143  │  │ TCP/23   │             │   │
│   │   └──────────┘  └──────────┘  └──────────┘             │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   애플리케이션과 전송 계층의 관계:                              │
│   - 애플리케이션은 소켓을 통해 전송 계층에 접근                 │
│   - 포트 번호로 프로세스 식별                                   │
│   - TCP 또는 UDP 중 선택하여 사용                               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 계층 3: 전송 계층 (Transport Layer)

```
┌─────────────────────────────────────────────────────────────────┐
│                3계층: 전송 계층 (Transport Layer)                │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   역할: 종단 간(End-to-End) 데이터 전송 서비스 제공             │
│                                                                  │
│   두 가지 주요 프로토콜:                                        │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │           TCP                        UDP                 │   │
│   │   ┌─────────────────┐       ┌─────────────────┐         │   │
│   │   │ 연결 지향       │       │ 비연결          │         │   │
│   │   │ 신뢰성 보장     │       │ 신뢰성 없음     │         │   │
│   │   │ 순서 보장       │       │ 순서 보장 안함  │         │   │
│   │   │ 흐름/혼잡 제어  │       │ 제어 없음       │         │   │
│   │   │ 오버헤드 높음   │       │ 오버헤드 낮음   │         │   │
│   │   └─────────────────┘       └─────────────────┘         │   │
│   │                                                          │   │
│   │   사용: 웹, 이메일,         사용: DNS, 스트리밍,        │   │
│   │         파일 전송                  게임, VoIP           │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   포트 번호:                                                    │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   ┌─────────────────────────────────────────────────┐   │   │
│   │   │        범위          │          용도             │   │   │
│   │   ├─────────────────────────────────────────────────┤   │   │
│   │   │  0 ~ 1023            │  Well-known (시스템)     │   │   │
│   │   │  1024 ~ 49151        │  Registered (등록)       │   │   │
│   │   │  49152 ~ 65535       │  Dynamic (동적/임시)     │   │   │
│   │   └─────────────────────────────────────────────────┘   │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   소켓 (Socket):                                                │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │   IP 주소 + 포트 번호 = 소켓                            │   │
│   │   예: 192.168.1.100:8080                                │   │
│   │                                                          │   │
│   │   소켓 쌍으로 연결 식별:                                │   │
│   │   (송신IP:송신Port, 수신IP:수신Port)                    │   │
│   │   예: (192.168.1.100:50000, 93.184.216.34:443)          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 계층 2: 인터넷 계층 (Internet Layer)

```
┌─────────────────────────────────────────────────────────────────┐
│                2계층: 인터넷 계층 (Internet Layer)               │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   역할: 논리적 주소 지정(IP), 패킷 라우팅                       │
│         이기종 네트워크 간 데이터 전달                          │
│                                                                  │
│   핵심: IP (Internet Protocol)                                  │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   특징:                                                  │   │
│   │   - 비연결 (Connectionless)                             │   │
│   │   - 최선형 전달 (Best-effort Delivery)                  │   │
│   │   - 신뢰성 보장 안함 (상위 계층인 TCP가 담당)           │   │
│   │                                                          │   │
│   │   기능:                                                  │   │
│   │   - 주소 지정 (IP 주소)                                 │   │
│   │   - 라우팅 (경로 결정)                                  │   │
│   │   - 단편화 (Fragmentation)                              │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   IP 패킷 구조 (IPv4):                                          │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │    0                   1                   2             3   │
│   │    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7  │
│   │   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  │
│   │   |Ver| IHL |  TOS  |         Total Length              |  │
│   │   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  │
│   │   |      Identification      |Flg|   Fragment Offset    |  │
│   │   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  │
│   │   |   TTL   | Protocol |       Header Checksum           |  │
│   │   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  │
│   │   |                  Source IP Address                   |  │
│   │   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  │
│   │   |               Destination IP Address                 |  │
│   │   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  │
│   │   |                     Options + Data                   |  │
│   │   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   주요 프로토콜:                                                │
│   ┌──────────┬───────────────────────────────────────────────┐  │
│   │   IP     │ 주소 지정, 라우팅 (IPv4, IPv6)               │  │
│   │   ICMP   │ 오류 보고, 진단 (ping, traceroute)           │  │
│   │   ARP    │ IP 주소 → MAC 주소 변환                      │  │
│   │   RARP   │ MAC 주소 → IP 주소 변환                      │  │
│   │   IGMP   │ 멀티캐스트 그룹 관리                         │  │
│   └──────────┴───────────────────────────────────────────────┘  │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 계층 1: 네트워크 접근 계층 (Network Access Layer)

```
┌─────────────────────────────────────────────────────────────────┐
│           1계층: 네트워크 접근 계층 (Network Access Layer)       │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   역할: 물리적 네트워크 접근, 프레임 전송                       │
│         OSI의 데이터링크 + 물리 계층에 해당                     │
│                                                                  │
│   OSI 모델과의 관계:                                            │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │   OSI 2계층: 데이터링크                                  │   │
│   │   OSI 1계층: 물리                                        │   │
│   │        ↓                                                 │   │
│   │   TCP/IP: 네트워크 접근 계층 (하나로 통합)              │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   기능:                                                         │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   1. 물리적 주소 지정 (MAC Address)                     │   │
│   │      - 48비트 하드웨어 주소                             │   │
│   │      - 예: 00:1A:2B:3C:4D:5E                            │   │
│   │                                                          │   │
│   │   2. 프레이밍                                            │   │
│   │      - IP 패킷을 프레임으로 캡슐화                      │   │
│   │      - 헤더, 트레일러 추가                              │   │
│   │                                                          │   │
│   │   3. 매체 접근 제어                                      │   │
│   │      - CSMA/CD (이더넷)                                 │   │
│   │      - CSMA/CA (Wi-Fi)                                  │   │
│   │                                                          │   │
│   │   4. 비트 전송                                           │   │
│   │      - 전기/광/무선 신호 변환                           │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   기술/프로토콜:                                                │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   유선:                                                  │   │
│   │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │   │
│   │   │  이더넷      │  │    PPP       │  │  FDDI        │  │   │
│   │   │  (802.3)     │  │ (점대점)     │  │ (광섬유)     │  │   │
│   │   └──────────────┘  └──────────────┘  └──────────────┘  │   │
│   │                                                          │   │
│   │   무선:                                                  │   │
│   │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │   │
│   │   │   Wi-Fi      │  │  Bluetooth   │  │     5G       │  │   │
│   │   │  (802.11)    │  │  (802.15)    │  │   (NR)       │  │   │
│   │   └──────────────┘  └──────────────┘  └──────────────┘  │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 4. OSI와 TCP/IP 비교

### 계층 구조 비교

```
┌─────────────────────────────────────────────────────────────────┐
│                    OSI vs TCP/IP 계층 비교                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│        OSI 7계층                      TCP/IP 4계층              │
│                                                                  │
│   ┌─────────────────┐                                           │
│   │ 7. 응용 계층    │                                           │
│   ├─────────────────┤            ┌─────────────────┐            │
│   │ 6. 표현 계층    │  ───────►  │ 4. 응용 계층    │            │
│   ├─────────────────┤            └─────────────────┘            │
│   │ 5. 세션 계층    │                                           │
│   ├─────────────────┤            ┌─────────────────┐            │
│   │ 4. 전송 계층    │  ───────►  │ 3. 전송 계층    │            │
│   ├─────────────────┤            └─────────────────┘            │
│   │ 3. 네트워크 계층│  ───────►  ┌─────────────────┐            │
│   ├─────────────────┤            │ 2. 인터넷 계층  │            │
│   │ 2. 데이터링크   │            └─────────────────┘            │
│   ├─────────────────┤  ───────►  ┌─────────────────┐            │
│   │ 1. 물리 계층    │            │ 1. 네트워크 접근│            │
│   └─────────────────┘            └─────────────────┘            │
│                                                                  │
│   OSI: 7계층 (이론적)            TCP/IP: 4계층 (실용적)         │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 상세 비교표

```
┌─────────────────────────────────────────────────────────────────┐
│                     OSI vs TCP/IP 상세 비교                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   ┌──────────────┬─────────────────┬────────────────────────┐   │
│   │     항목     │      OSI        │       TCP/IP           │   │
│   ├──────────────┼─────────────────┼────────────────────────┤   │
│   │ 계층 수      │      7계층      │        4계층           │   │
│   ├──────────────┼─────────────────┼────────────────────────┤   │
│   │ 개발 주체    │      ISO        │     DARPA (미국방부)   │   │
│   ├──────────────┼─────────────────┼────────────────────────┤   │
│   │ 개발 시기    │    1984년       │      1970년대          │   │
│   ├──────────────┼─────────────────┼────────────────────────┤   │
│   │ 목적         │   참조 모델     │      실제 구현         │   │
│   ├──────────────┼─────────────────┼────────────────────────┤   │
│   │ 성격         │   이론적/교육용 │      실용적/표준       │   │
│   ├──────────────┼─────────────────┼────────────────────────┤   │
│   │ 프로토콜     │   별도 정의     │      함께 정의         │   │
│   ├──────────────┼─────────────────┼────────────────────────┤   │
│   │ 계층 경계    │   명확함        │      유연함            │   │
│   ├──────────────┼─────────────────┼────────────────────────┤   │
│   │ 신뢰성       │   전송 계층만   │      전송 계층만       │   │
│   ├──────────────┼─────────────────┼────────────────────────┤   │
│   │ 현재 사용    │   참조/교육용   │      인터넷 표준       │   │
│   └──────────────┴─────────────────┴────────────────────────┘   │
│                                                                  │
│   핵심 차이점:                                                  │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │ 1. OSI는 프로토콜보다 모델이 먼저 만들어짐 (Top-down)   │   │
│   │    TCP/IP는 프로토콜이 먼저, 모델은 나중 (Bottom-up)    │   │
│   │                                                          │   │
│   │ 2. OSI는 각 계층이 독립적으로 정의                       │   │
│   │    TCP/IP는 계층 간 상호작용 고려                        │   │
│   │                                                          │   │
│   │ 3. OSI의 세션/표현 계층은 TCP/IP에서 응용 계층에 통합   │   │
│   │                                                          │   │
│   │ 4. TCP/IP가 사실상의 인터넷 표준 (de facto standard)    │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 왜 TCP/IP가 승리했는가?

```
┌─────────────────────────────────────────────────────────────────┐
│                  TCP/IP 성공 요인                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   1. 실용성 (Practicality)                                      │
│      ┌─────────────────────────────────────────────────────┐    │
│      │ - 실제 구현을 먼저 하고 모델화                       │    │
│      │ - 작동하는 코드와 함께 발전                          │    │
│      │ - "Rough consensus and running code"                 │    │
│      └─────────────────────────────────────────────────────┘    │
│                                                                  │
│   2. 개방성 (Openness)                                          │
│      ┌─────────────────────────────────────────────────────┐    │
│      │ - 누구나 무료로 사용 가능                            │    │
│      │ - RFC로 표준 공개                                     │    │
│      │ - 독점 기술 없음                                      │    │
│      └─────────────────────────────────────────────────────┘    │
│                                                                  │
│   3. 유연성 (Flexibility)                                       │
│      ┌─────────────────────────────────────────────────────┐    │
│      │ - 다양한 네트워크 기술 수용                          │    │
│      │ - 새로운 애플리케이션 쉽게 추가                      │    │
│      │ - 이기종 시스템 연결                                  │    │
│      └─────────────────────────────────────────────────────┘    │
│                                                                  │
│   4. 선점 효과 (First-mover Advantage)                          │
│      ┌─────────────────────────────────────────────────────┐    │
│      │ - ARPANET에서 이미 사용                              │    │
│      │ - 대학과 연구소에서 먼저 보급                        │    │
│      │ - BSD Unix에 기본 포함                               │    │
│      └─────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 5. 각 계층의 프로토콜

### 프로토콜 스택 전체도

```
┌─────────────────────────────────────────────────────────────────┐
│                   TCP/IP 프로토콜 스택                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                     응용 계층                            │   │
│   │                                                          │   │
│   │  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐       │   │
│   │  │HTTP │ │ FTP │ │SMTP │ │ DNS │ │ SSH │ │DHCP │       │   │
│   │  │HTTPS│ │SFTP │ │POP3 │ │     │ │     │ │     │       │   │
│   │  └──┬──┘ └──┬──┘ └──┬──┘ └──┬──┘ └──┬──┘ └──┬──┘       │   │
│   │     │       │       │       │       │       │            │   │
│   └─────┼───────┼───────┼───────┼───────┼───────┼────────────┘   │
│         │       │       │       │       │       │                │
│   ┌─────┼───────┼───────┼───────┼───────┼───────┼────────────┐   │
│   │     ▼       ▼       ▼       │       ▼       │  전송 계층 │   │
│   │  ┌─────────────────────────┐│   ┌───────────┐            │   │
│   │  │          TCP            ││   │    UDP    │            │   │
│   │  │  (연결 지향, 신뢰성)    ││   │  (비연결) │            │   │
│   │  └───────────┬─────────────┘│   └─────┬─────┘            │   │
│   │              │              │         │                   │   │
│   └──────────────┼──────────────┼─────────┼───────────────────┘   │
│                  │              │         │                       │
│   ┌──────────────┼──────────────┼─────────┼───────────────────┐   │
│   │              ▼              ▼         ▼       인터넷 계층 │   │
│   │            ┌─────────────────────────────┐                │   │
│   │            │            IP               │                │   │
│   │            │    (주소 지정, 라우팅)      │                │   │
│   │            └──────────────┬──────────────┘                │   │
│   │                           │                               │   │
│   │    ┌──────────┬───────────┼───────────┬──────────┐       │   │
│   │    │   ICMP   │    ARP    │   RARP    │   IGMP   │       │   │
│   │    └──────────┴───────────┴───────────┴──────────┘       │   │
│   │                           │                               │   │
│   └───────────────────────────┼───────────────────────────────┘   │
│                               │                                   │
│   ┌───────────────────────────┼───────────────────────────────┐   │
│   │                           ▼          네트워크 접근 계층   │   │
│   │    ┌───────────┐   ┌───────────┐   ┌───────────┐         │   │
│   │    │  이더넷   │   │   Wi-Fi   │   │    PPP    │         │   │
│   │    │  (802.3)  │   │  (802.11) │   │           │         │   │
│   │    └───────────┘   └───────────┘   └───────────┘         │   │
│   │                                                           │   │
│   └───────────────────────────────────────────────────────────┘   │
│                               │                                   │
│                               ▼                                   │
│                      물리적 전송 매체                            │
│                (케이블, 광섬유, 무선 전파)                       │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 주요 프로토콜 상세

```
┌─────────────────────────────────────────────────────────────────┐
│                    응용 계층 프로토콜                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   프로토콜    포트      전송     설명                           │
│   ─────────────────────────────────────────────────────────────│
│   HTTP        80       TCP      하이퍼텍스트 전송               │
│   HTTPS       443      TCP      보안 HTTP (TLS)                 │
│   FTP         20/21    TCP      파일 전송 (데이터/제어)         │
│   SSH         22       TCP      보안 원격 접속                  │
│   Telnet      23       TCP      원격 접속 (비보안)              │
│   SMTP        25       TCP      메일 전송                       │
│   DNS         53       UDP/TCP  도메인 이름 해석                │
│   DHCP        67/68    UDP      IP 주소 자동 할당               │
│   TFTP        69       UDP      간단한 파일 전송                │
│   HTTP/3      443      QUIC     차세대 HTTP                     │
│   POP3        110      TCP      메일 수신                       │
│   IMAP        143      TCP      메일 접근                       │
│   SNMP        161/162  UDP      네트워크 관리                   │
│   LDAP        389      TCP      디렉토리 서비스                 │
│   HTTPS(SMTPS)465      TCP      보안 메일 전송                  │
│   IMAPS       993      TCP      보안 메일 접근                  │
│   POP3S       995      TCP      보안 메일 수신                  │
│   MySQL       3306     TCP      데이터베이스                    │
│   RDP         3389     TCP      원격 데스크톱                   │
│   PostgreSQL  5432     TCP      데이터베이스                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### ICMP (Internet Control Message Protocol)

```
┌─────────────────────────────────────────────────────────────────┐
│                          ICMP                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   역할: 네트워크 오류 보고 및 진단                              │
│                                                                  │
│   주요 메시지 유형:                                             │
│   ┌──────────┬───────────────────────────────────────────────┐  │
│   │ Type 0   │ Echo Reply (ping 응답)                        │  │
│   │ Type 3   │ Destination Unreachable (목적지 도달 불가)    │  │
│   │ Type 5   │ Redirect (경로 변경 권고)                     │  │
│   │ Type 8   │ Echo Request (ping 요청)                      │  │
│   │ Type 11  │ Time Exceeded (TTL 만료)                      │  │
│   └──────────┴───────────────────────────────────────────────┘  │
│                                                                  │
│   ping 명령:                                                    │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │   $ ping 8.8.8.8                                         │   │
│   │   PING 8.8.8.8 (8.8.8.8): 56 data bytes                 │   │
│   │   64 bytes from 8.8.8.8: icmp_seq=0 ttl=117 time=9.2 ms │   │
│   │   64 bytes from 8.8.8.8: icmp_seq=1 ttl=117 time=8.9 ms │   │
│   │                                                          │   │
│   │   Type 8 (요청) → 대상 호스트 → Type 0 (응답)           │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   traceroute 명령:                                              │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │   TTL=1 패킷 전송 → 첫 번째 라우터에서 만료              │   │
│   │   TTL=2 패킷 전송 → 두 번째 라우터에서 만료              │   │
│   │   ...반복하여 경로상의 모든 라우터 발견                  │   │
│   │                                                          │   │
│   │   $ traceroute google.com                                │   │
│   │   1  192.168.1.1    1.234 ms                             │   │
│   │   2  10.0.0.1       5.678 ms                             │   │
│   │   3  ...                                                 │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### ARP (Address Resolution Protocol)

```
┌─────────────────────────────────────────────────────────────────┐
│                           ARP                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   역할: IP 주소 → MAC 주소 변환                                 │
│                                                                  │
│   동작 과정:                                                    │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   1. ARP Request (브로드캐스트)                         │   │
│   │                                                          │   │
│   │   호스트 A                        네트워크의 모든 호스트 │   │
│   │   ┌─────────┐   "192.168.1.2의    ┌─────────┐           │   │
│   │   │ IP:     │    MAC 주소가       │ IP:     │           │   │
│   │   │192.168  │    뭐지?"           │192.168  │           │   │
│   │   │ .1.1    │ ═══════════════════►│ .1.2    │           │   │
│   │   │ MAC:    │                     │ MAC:    │           │   │
│   │   │ AA:BB:  │                     │ CC:DD:  │           │   │
│   │   │ CC:DD:  │                     │ EE:FF:  │           │   │
│   │   │ EE:FF   │                     │ 00:11   │           │   │
│   │   └─────────┘                     └─────────┘           │   │
│   │                                                          │   │
│   │   2. ARP Reply (유니캐스트)                             │   │
│   │                                                          │   │
│   │   호스트 A                        호스트 B               │   │
│   │   ┌─────────┐   "내 MAC 주소는    ┌─────────┐           │   │
│   │   │         │◄═══════════════════ │ CC:DD:  │           │   │
│   │   │         │    CC:DD:EE:FF:     │ EE:FF:  │           │   │
│   │   │         │    00:11 이야"      │ 00:11   │           │   │
│   │   └─────────┘                     └─────────┘           │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   ARP 테이블:                                                   │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │   $ arp -a                                               │   │
│   │   Internet Address    Physical Address    Type           │   │
│   │   192.168.1.1         aa-bb-cc-dd-ee-ff   dynamic       │   │
│   │   192.168.1.2         cc-dd-ee-ff-00-11   dynamic       │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   * ARP 캐시: 일정 시간 동안 결과를 저장하여 효율성 향상        │
│   * ARP는 같은 네트워크(서브넷) 내에서만 동작                   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. 실제 통신 흐름

### 웹 페이지 요청 전체 과정

```
┌─────────────────────────────────────────────────────────────────┐
│            www.example.com 웹 페이지 요청 과정                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   사용자: 브라우저에 www.example.com 입력                       │
│                                                                  │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  단계 1: DNS 조회 (도메인 → IP)                          │   │
│   │                                                          │   │
│   │  브라우저 → DNS 서버                                     │   │
│   │  "www.example.com의 IP는?"                               │   │
│   │                                                          │   │
│   │  DNS 서버 → 브라우저                                     │   │
│   │  "93.184.216.34"                                         │   │
│   └─────────────────────────────────────────────────────────┘   │
│                           ↓                                      │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  단계 2: TCP 연결 (3-way handshake)                      │   │
│   │                                                          │   │
│   │  클라이언트                        서버                   │   │
│   │      │ ──────── SYN ─────────► │                        │   │
│   │      │ ◄─────── SYN-ACK ─────── │                        │   │
│   │      │ ──────── ACK ─────────► │                        │   │
│   │                                                          │   │
│   │  연결 수립됨 (세션 시작)                                │   │
│   └─────────────────────────────────────────────────────────┘   │
│                           ↓                                      │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  단계 3: HTTP 요청                                       │   │
│   │                                                          │   │
│   │  클라이언트 → 서버                                       │   │
│   │  ┌─────────────────────────────────────────────────┐    │   │
│   │  │ GET / HTTP/1.1                                   │    │   │
│   │  │ Host: www.example.com                            │    │   │
│   │  │ User-Agent: Mozilla/5.0...                       │    │   │
│   │  │ Accept: text/html...                             │    │   │
│   │  └─────────────────────────────────────────────────┘    │   │
│   └─────────────────────────────────────────────────────────┘   │
│                           ↓                                      │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  단계 4: HTTP 응답                                       │   │
│   │                                                          │   │
│   │  서버 → 클라이언트                                       │   │
│   │  ┌─────────────────────────────────────────────────┐    │   │
│   │  │ HTTP/1.1 200 OK                                  │    │   │
│   │  │ Content-Type: text/html                          │    │   │
│   │  │ Content-Length: 1256                             │    │   │
│   │  │                                                  │    │   │
│   │  │ <!DOCTYPE html>                                  │    │   │
│   │  │ <html>...                                        │    │   │
│   │  └─────────────────────────────────────────────────┘    │   │
│   └─────────────────────────────────────────────────────────┘   │
│                           ↓                                      │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  단계 5: TCP 연결 종료 (4-way handshake)                 │   │
│   │                                                          │   │
│   │  클라이언트                        서버                   │   │
│   │      │ ──────── FIN ─────────► │                        │   │
│   │      │ ◄─────── ACK ─────────── │                        │   │
│   │      │ ◄─────── FIN ─────────── │                        │   │
│   │      │ ──────── ACK ─────────► │                        │   │
│   │                                                          │   │
│   │  연결 종료됨                                            │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 캡슐화 과정 상세

```
┌─────────────────────────────────────────────────────────────────┐
│                      캡슐화 상세 과정                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   응용 계층 (HTTP 요청)                                         │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │              HTTP DATA (GET / HTTP/1.1...)               │   │
│   └─────────────────────────────────────────────────────────┘   │
│                              ↓                                   │
│   전송 계층 (TCP)                                               │
│   ┌────────────┬────────────────────────────────────────────┐   │
│   │ TCP Header │              HTTP DATA                      │   │
│   │ Src: 50000 │                                             │   │
│   │ Dst: 80    │                                             │   │
│   │ Seq: 1000  │                                             │   │
│   └────────────┴────────────────────────────────────────────┘   │
│                              ↓                                   │
│   인터넷 계층 (IP)                                              │
│   ┌────────────┬────────────┬────────────────────────────────┐  │
│   │ IP Header  │ TCP Header │          HTTP DATA             │  │
│   │ Src: 192.  │            │                                │  │
│   │ 168.1.100  │            │                                │  │
│   │ Dst: 93.   │            │                                │  │
│   │ 184.216.34 │            │                                │  │
│   │ TTL: 64    │            │                                │  │
│   └────────────┴────────────┴────────────────────────────────┘  │
│                              ↓                                   │
│   네트워크 접근 계층 (이더넷)                                   │
│   ┌──────┬────────────┬────────────┬──────────────────┬─────┐   │
│   │Pream │Eth Header  │ IP Header  │ TCP + HTTP DATA  │ FCS │   │
│   │ble   │Src MAC:    │            │                  │     │   │
│   │      │aa:bb:cc... │            │                  │     │   │
│   │      │Dst MAC:    │            │                  │     │   │
│   │      │11:22:33... │            │                  │     │   │
│   └──────┴────────────┴────────────┴──────────────────┴─────┘   │
│                              ↓                                   │
│   물리 계층 (비트 스트림)                                       │
│   10110100 01101011 11010010 10101100 01011001 ...              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 라우팅 과정

```
┌─────────────────────────────────────────────────────────────────┐
│                       라우팅 과정                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   출발지: 192.168.1.100                                         │
│   목적지: 93.184.216.34                                         │
│                                                                  │
│   ┌─────────────┐                                               │
│   │ 클라이언트  │  192.168.1.100                                │
│   └──────┬──────┘                                               │
│          │                                                       │
│          │ ① 같은 네트워크가 아니므로 기본 게이트웨이로 전송   │
│          │    (ARP로 게이트웨이의 MAC 주소 획득)                │
│          ▼                                                       │
│   ┌─────────────┐                                               │
│   │  라우터 A   │  192.168.1.1 (내부) / 10.0.0.1 (외부)         │
│   └──────┬──────┘                                               │
│          │                                                       │
│          │ ② 라우팅 테이블 참조, 다음 홉 결정                  │
│          │    IP 헤더의 TTL 감소 (64 → 63)                      │
│          │    새로운 이더넷 프레임 생성                         │
│          ▼                                                       │
│   ┌─────────────┐                                               │
│   │  라우터 B   │  ISP 라우터                                   │
│   └──────┬──────┘                                               │
│          │                                                       │
│          │ ③ 계속 라우팅...                                     │
│          │    (TTL 감소, 프레임 재생성)                         │
│          ▼                                                       │
│        ......                                                   │
│          │                                                       │
│          │ ④ 목적지 네트워크 도달                               │
│          ▼                                                       │
│   ┌─────────────┐                                               │
│   │   서버      │  93.184.216.34                                │
│   └─────────────┘                                               │
│                                                                  │
│   각 홉(Hop)에서:                                               │
│   - IP 패킷은 변경되지 않음 (TTL, 체크섬 제외)                 │
│   - 이더넷 프레임은 새로 생성 (MAC 주소 변경)                  │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 7. TCP vs UDP

### TCP 상세

```
┌─────────────────────────────────────────────────────────────────┐
│              TCP (Transmission Control Protocol)                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   특징: 연결 지향, 신뢰성 보장, 순서 보장                       │
│                                                                  │
│   3-Way Handshake (연결 수립):                                  │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   클라이언트                           서버              │   │
│   │       │                                  │               │   │
│   │       │ ─────── SYN (seq=x) ──────────► │               │   │
│   │       │                                  │               │   │
│   │       │ ◄────── SYN-ACK ──────────────  │               │   │
│   │       │         (seq=y, ack=x+1)         │               │   │
│   │       │                                  │               │   │
│   │       │ ─────── ACK (ack=y+1) ────────► │               │   │
│   │       │                                  │               │   │
│   │       │         연결 수립됨               │               │   │
│   │       │                                  │               │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   데이터 전송 (슬라이딩 윈도우):                                │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   송신 윈도우 (Window Size = 4)                         │   │
│   │                                                          │   │
│   │   ┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┐            │   │
│   │   │ 1 │ 2 │ 3 │ 4 │ 5 │ 6 │ 7 │ 8 │ 9 │10 │            │   │
│   │   └───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘            │   │
│   │     ▲                   ▲                               │   │
│   │     └─────┬─────────────┘                               │   │
│   │           │                                              │   │
│   │   ACK 없이 전송 가능한 범위                             │   │
│   │                                                          │   │
│   │   ACK 수신 시 윈도우가 앞으로 "슬라이드"                │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   4-Way Handshake (연결 종료):                                  │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   클라이언트                           서버              │   │
│   │       │                                  │               │   │
│   │       │ ─────── FIN ────────────────► │               │   │
│   │       │                                  │               │   │
│   │       │ ◄────── ACK ────────────────  │               │   │
│   │       │                                  │               │   │
│   │       │ ◄────── FIN ────────────────  │               │   │
│   │       │                                  │               │   │
│   │       │ ─────── ACK ────────────────► │               │   │
│   │       │                                  │               │   │
│   │       │         연결 종료됨               │               │   │
│   │       │                                  │               │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   혼잡 제어 (Congestion Control):                               │
│   - Slow Start: 윈도우 크기를 작게 시작, 지수적 증가           │
│   - Congestion Avoidance: 임계값 이후 선형적 증가              │
│   - Fast Retransmit: 중복 ACK 3개 시 즉시 재전송               │
│   - Fast Recovery: 혼잡 후 빠른 회복                           │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### UDP 상세

```
┌─────────────────────────────────────────────────────────────────┐
│                UDP (User Datagram Protocol)                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   특징: 비연결, 신뢰성 없음, 순서 보장 안함, 빠른 전송          │
│                                                                  │
│   통신 방식:                                                    │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   송신자                               수신자            │   │
│   │       │                                  │               │   │
│   │       │ ═══════ 데이터그램 1 ═══════► │               │   │
│   │       │ ═══════ 데이터그램 2 ═══════► │               │   │
│   │       │ ═══════ 데이터그램 3 ═══════► │               │   │
│   │       │                                  │               │   │
│   │       │      (ACK 없음, 연결 없음)       │               │   │
│   │       │                                  │               │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   UDP 헤더 (8바이트):                                           │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   0       8      16      24      32                      │   │
│   │   ┌───────────────┬───────────────┐                     │   │
│   │   │   Source Port │    Dest Port   │                     │   │
│   │   ├───────────────┼───────────────┤                     │   │
│   │   │     Length    │    Checksum    │                     │   │
│   │   └───────────────┴───────────────┘                     │   │
│   │                                                          │   │
│   │   TCP 헤더(20+ 바이트)보다 훨씬 단순                    │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
│   사용 사례:                                                    │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                          │   │
│   │   1. DNS 쿼리                                           │   │
│   │      - 작은 데이터, 빠른 응답 필요                      │   │
│   │      - 실패 시 재시도 (애플리케이션 레벨)               │   │
│   │                                                          │   │
│   │   2. 비디오/오디오 스트리밍                             │   │
│   │      - 실시간성 중요                                    │   │
│   │      - 일부 손실 허용 가능                              │   │
│   │                                                          │   │
│   │   3. 온라인 게임                                        │   │
│   │      - 낮은 지연 필요                                   │   │
│   │      - 오래된 데이터보다 최신 데이터가 중요             │   │
│   │                                                          │   │
│   │   4. VoIP                                               │   │
│   │      - 실시간 음성 통화                                 │   │
│   │      - 재전송보다 무시가 나음                           │   │
│   │                                                          │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### TCP vs UDP 비교

```
┌─────────────────────────────────────────────────────────────────┐
│                      TCP vs UDP 비교                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   ┌─────────────────┬─────────────────┬─────────────────────┐   │
│   │      특성       │      TCP        │        UDP          │   │
│   ├─────────────────┼─────────────────┼─────────────────────┤   │
│   │ 연결 방식       │ 연결 지향       │ 비연결              │   │
│   │ 신뢰성          │ 보장            │ 비보장              │   │
│   │ 순서 보장       │ 보장            │ 비보장              │   │
│   │ 흐름 제어       │ 있음            │ 없음                │   │
│   │ 혼잡 제어       │ 있음            │ 없음                │   │
│   │ 오버헤드        │ 높음 (20+바이트)│ 낮음 (8바이트)      │   │
│   │ 속도            │ 상대적 느림     │ 빠름                │   │
│   │ 재전송          │ 자동            │ 없음                │   │
│   │ 브로드캐스트    │ 불가            │ 가능                │   │
│   │ 멀티캐스트      │ 불가            │ 가능                │   │
│   ├─────────────────┼─────────────────┼─────────────────────┤   │
│   │                 │ 웹 (HTTP)       │ DNS                 │   │
│   │ 사용 예시       │ 이메일 (SMTP)   │ 스트리밍            │   │
│   │                 │ 파일 전송 (FTP) │ 게임                │   │
│   │                 │ SSH             │ VoIP                │   │
│   └─────────────────┴─────────────────┴─────────────────────┘   │
│                                                                  │
│   선택 기준:                                                    │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │ TCP를 선택할 때:                                         │   │
│   │ - 데이터 무결성이 중요할 때                             │   │
│   │ - 모든 데이터가 도착해야 할 때                          │   │
│   │ - 순서가 중요할 때                                      │   │
│   │                                                          │   │
│   │ UDP를 선택할 때:                                         │   │
│   │ - 실시간성이 중요할 때                                  │   │
│   │ - 일부 손실이 허용될 때                                 │   │
│   │ - 브로드캐스트/멀티캐스트가 필요할 때                   │   │
│   │ - 빠른 응답이 필요할 때                                 │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 8. 연습 문제

### 기초 문제

**1. TCP/IP 모델의 4계층을 아래에서 위로 순서대로 나열하시오.**

**2. 다음 프로토콜을 TCP와 UDP로 분류하시오.**
   - HTTP, DNS, FTP, VoIP, SMTP, 온라인 게임

**3. 다음 설명에 해당하는 프로토콜을 고르시오.**
   - IP 주소를 MAC 주소로 변환: (  )
   - 네트워크 오류 보고 및 ping: (  )
   - 도메인 이름을 IP로 변환: (  )

   보기: DNS, ARP, ICMP, DHCP

**4. TCP 3-way handshake의 순서를 설명하시오.**

### 응용 문제

**5. www.google.com에 접속할 때 발생하는 네트워크 통신 과정을 순서대로 설명하시오.**

**6. TCP와 UDP의 차이점을 5가지 이상 설명하시오.**

**7. 다음 상황에서 TCP와 UDP 중 어떤 것을 사용하는 것이 적절한지 이유와 함께 설명하시오.**
   - (a) 온라인 뱅킹 서비스
   - (b) 실시간 화상 회의
   - (c) 대용량 파일 다운로드

### 심화 문제

**8. OSI 7계층과 TCP/IP 4계층을 비교하고, TCP/IP가 인터넷 표준이 된 이유를 설명하시오.**

**9. 다음 시나리오를 분석하시오:**
```
traceroute를 실행했더니 5번째 홉에서 "* * *"가 표시됩니다.
가능한 원인은 무엇인가요?
```

**10. TCP의 혼잡 제어 메커니즘(Slow Start, Congestion Avoidance)이 필요한 이유와 동작 원리를 설명하시오.**

---

<details>
<summary>정답</summary>

**1.** 네트워크 접근 계층 → 인터넷 계층 → 전송 계층 → 응용 계층

**2.**
- TCP: HTTP, FTP, SMTP
- UDP: DNS (대부분), VoIP, 온라인 게임

**3.**
- IP → MAC: ARP
- 오류 보고/ping: ICMP
- 도메인 → IP: DNS

**4.**
1. 클라이언트 → 서버: SYN (seq=x)
2. 서버 → 클라이언트: SYN-ACK (seq=y, ack=x+1)
3. 클라이언트 → 서버: ACK (ack=y+1)

**5.**
1. DNS 조회로 도메인을 IP로 변환
2. TCP 3-way handshake로 연결 수립
3. TLS handshake (HTTPS인 경우)
4. HTTP 요청 전송
5. 서버에서 HTTP 응답 수신
6. 웹 페이지 렌더링
7. TCP 연결 종료 (4-way handshake)

**6.**
1. 연결 방식: TCP는 연결 지향, UDP는 비연결
2. 신뢰성: TCP는 보장, UDP는 비보장
3. 순서: TCP는 보장, UDP는 비보장
4. 속도: TCP는 느림, UDP는 빠름
5. 오버헤드: TCP 20바이트+, UDP 8바이트
6. 흐름/혼잡 제어: TCP만 있음
7. 브로드캐스트: UDP만 가능

**7.**
- (a) TCP - 금융 데이터는 무결성과 신뢰성이 필수
- (b) UDP - 실시간성이 중요, 일부 손실 허용
- (c) TCP - 모든 데이터가 정확히 도착해야 함

**8.**
- OSI는 이론적 7계층, TCP/IP는 실용적 4계층
- TCP/IP가 표준이 된 이유: 실용성, 개방성, 유연성, 선점 효과
- ARPANET에서 실제 동작하는 코드와 함께 발전

**9.** 가능한 원인:
- 해당 라우터가 ICMP 응답을 차단
- 방화벽에서 ICMP 필터링
- 라우터의 CPU 부하로 ICMP 처리 불가
- 네트워크 혼잡

**10.**
- 필요 이유: 네트워크 혼잡 방지, 공정한 대역폭 분배
- Slow Start: 윈도우 크기를 1에서 시작, 매 RTT마다 2배 증가
- Congestion Avoidance: 임계값(ssthresh) 도달 후 선형 증가
- 패킷 손실 감지 시 윈도우 크기 감소, 혼잡 완화

</details>

---

## 다음 단계

- [04_Physical_Layer.md](./04_Physical_Layer.md) - 물리 계층과 전송 매체

---

## 참고 자료

- TCP/IP Illustrated (W. Richard Stevens)
- Computer Networking: A Top-Down Approach (Kurose & Ross)
- [RFC 793: TCP](https://tools.ietf.org/html/rfc793)
- [RFC 768: UDP](https://tools.ietf.org/html/rfc768)
- [RFC 791: IP](https://tools.ietf.org/html/rfc791)

